{"title": "Execution through API", "descrption": "\nAdversary tools may directly use the Windows application programming interface (API) to execute binaries. Functions such as the Windows API CreateProcess will allow programs and scripts to start other processes with proper path and argument parameters. [1]Additional Windows API calls that can be used to execute binaries include: [2]CreateProcessA() and CreateProcessW(),CreateProcessAsUserA() and CreateProcessAsUserW(),CreateProcessInternalA() and CreateProcessInternalW(),CreateProcessWithLogonW(), CreateProcessWithTokenW(),LoadLibraryA() and LoadLibraryW(),LoadLibraryExA() and LoadLibraryExW(),LoadModule(),LoadPackagedLibrary(),WinExec(),ShellExecuteA() and ShellExecuteW(),ShellExecuteExA() and ShellExecuteExW()\n", "ID": "T1106", "Tactic": "Execution", "Platform": "Windows", "Permissions Required": "User, Administrator, SYSTEM", "Data Sources": "API monitoring, Process monitoring", "Contributors": "Stefan Kanthak", "Version": "1.0", "Created": "31 May 2017", "Last Modified": "17 July 2019", "references": [{"index": 1, "title": "Microsoft. (n.d.). CreateProcess function. Retrieved December 5, 2014.", "external_link": "http://msdn.microsoft.com/en-us/library/ms682425"}, {"index": 2, "title": "Kanthak, S. (2017). Application Verifier Provider. Retrieved February 13, 2017.", "external_link": "https://skanthak.homepage.t-online.de/verifier.html"}, {"index": 3, "title": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "external_link": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"index": 4, "title": "Gorzelany, A., Hall, J., Poggemeyer, L.. (2019, January 7). Windows Defender Application Control. Retrieved July 16, 2019.", "external_link": "https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/windows-defender-application-control"}, {"index": 5, "title": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "external_link": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"index": 6, "title": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "external_link": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"index": 7, "title": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "external_link": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"index": 8, "title": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "external_link": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}, {"index": 9, "title": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "external_link": "https://cobaltstrike.com/downloads/csmanual38.pdf"}, {"index": 10, "title": "Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.", "external_link": "https://github.com/PowerShellEmpire/Empire"}, {"index": 11, "title": "Bitdefender. (2015, December). APT28 Under the Scope. Retrieved February 23, 2017.", "external_link": "https://download.bitdefender.com/resources/media/materials/white-papers/en/Bitdefender_In-depth_analysis_of_APT28%E2%80%93The_Political_Cyber-Espionage.pdf"}, {"index": 12, "title": "Vasilenko, R. (2013, December 17). An Analysis of PlugX Malware. Retrieved November 24, 2015.", "external_link": "http://labs.lastline.com/an-analysis-of-plugx"}, {"index": 13, "title": "Settle, A., et al. (2016, August 8). MONSOON - Analysis Of An APT Campaign. Retrieved September 22, 2016.", "external_link": "https://www.forcepoint.com/sites/default/files/resources/files/forcepoint-security-labs-monsoon-analysis-report.pdf"}, {"index": 14, "title": "Lunghi, D., et al. (2017, December). Untangling the Patchwork Cyberespionage Group. Retrieved July 10, 2018.", "external_link": "https://documents.trendmicro.com/assets/tech-brief-untangling-the-patchwork-cyberespionage-group.pdf"}, {"index": 15, "title": "US-CERT. (2017, November 01). Malware Analysis Report (MAR) - 10135536-D. Retrieved July 16, 2018.", "external_link": "https://www.us-cert.gov/sites/default/files/publications/MAR-10135536-D_WHITE_S508C.PDF"}, {"index": 16, "title": "Sherstobitoff, R. (2018, March 08). Hidden Cobra Targets Turkish Financial Sector With New Bankshot Implant. Retrieved May 18, 2018.", "external_link": "https://securingtomorrow.mcafee.com/mcafee-labs/hidden-cobra-targets-turkish-financial-sector-new-bankshot-implant/"}, {"index": 17, "title": "Salinas, M., Holguin, J. (2017, June). Evolution of Trickbot. Retrieved July 31, 2018.", "external_link": "https://www.securityartwork.es/wp-content/uploads/2017/07/Trickbot-report-S2-Grupo.pdf"}, {"index": 18, "title": "ASERT Team. (2018, April 04). Innaput Actors Utilize Remote Access Trojan Since 2016, Presumably Targeting Victim Files. Retrieved July 9, 2018.", "external_link": "https://asert.arbornetworks.com/innaput-actors-utilize-remote-access-trojan-since-2016-presumably-targeting-victim-files/"}, {"index": 19, "title": "ESET, et al. (2018, January). Diplomats in Eastern Europe bitten by a Turla mosquito. Retrieved July 3, 2018.", "external_link": "https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf"}, {"index": 20, "title": "Robert Falcone. (2017, February 14). XAgentOSX: Sofacy's Xagent macOS Tool. Retrieved July 12, 2017.", "external_link": "https://researchcenter.paloaltonetworks.com/2017/02/unit42-xagentosx-sofacys-xagent-macos-tool/"}, {"index": 21, "title": "Ivanov, A. et al.. (2018, May 7). SynAck targeted ransomware uses the Doppelg\u00e4nging technique. Retrieved May 22, 2018.", "external_link": "https://securelist.com/synack-targeted-ransomware-uses-the-doppelganging-technique/85431/"}, {"index": 22, "title": "Bettencourt, J. (2018, May 7). Kaspersky Lab finds new variant of SynAck ransomware using sophisticated Doppelg\u00e4nging technique. Retrieved May 24, 2018.", "external_link": "https://usa.kaspersky.com/about/press-releases/2018_synack-doppelganging"}, {"index": 23, "title": "Vaish, A. & Nemes, S. (2017, November 28). Newly Observed Ursnif Variant Employs Malicious TLS Callback Technique to Achieve Process Injection. Retrieved June 5, 2019.", "external_link": "https://www.fireeye.com/blog/threat-research/2017/11/ursnif-variant-malicious-tls-callback-technique.html"}, {"index": 24, "title": "Patil, S. and Williams, M.. (2019, June 5). Government Sector in Central Asia Targeted With New HAWKBALL Backdoor Delivered via Microsoft Office Vulnerabilities. Retrieved June 20, 2019.", "external_link": "https://www.fireeye.com/blog/threat-research/2019/06/government-in-central-asia-targeted-with-hawkball-backdoor.html"}, {"index": 25, "title": "Faou, M. (2019, May). Turla LightNeuron: One email away from remote code execution. Retrieved June 24, 2019.", "external_link": "https://www.welivesecurity.com/wp-content/uploads/2019/05/ESET-LightNeuron.pdf"}, {"index": 26, "title": "Falcone, R. and Lancaster, T.. (2019, May 28). Emissary Panda Attacks Middle East Government Sharepoint Servers. Retrieved July 9, 2019.", "external_link": "https://unit42.paloaltonetworks.com/emissary-panda-attacks-middle-east-government-sharepoint-servers/"}, {"index": 27, "title": "Carr, N, et all. (2019, October 10). Mahalo FIN7: Responding to the Criminal Operators\u2019 New Tools and Techniques. Retrieved October 11, 2019.", "external_link": "https://www.fireeye.com/blog/threat-research/2019/10/mahalo-fin7-responding-to-new-tools-and-techniques.html"}, {"index": 28, "title": "Mercer, W., Rascagneres, P. (2018, January 16). Korea In The Crosshairs. Retrieved May 21, 2018.", "external_link": "https://blog.talosintelligence.com/2018/01/korea-in-crosshairs.html"}, {"index": 29, "title": "Falcone, R., et al. (2018, August 02). The Gorgon Group: Slithering Between Nation State and Cybercrime. Retrieved August 7, 2018.", "external_link": "https://researchcenter.paloaltonetworks.com/2018/08/unit42-gorgon-group-slithering-nation-state-cybercrime/"}, {"index": 30, "title": "GReAT. (2017, November 1). Silence \u2013 a new Trojan attacking financial organizations. Retrieved May 24, 2019.", "external_link": "https://securelist.com/the-silence/83009/"}, {"index": 31, "title": "Faou, M. and Dumont R.. (2019, May 29). A dive into Turla PowerShell usage. Retrieved June 14, 2019.", "external_link": "https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/"}], "related": [{"link": "https://attack.mitre.org/software/S0045", "Name": "ADVSTORESHELL", "Description": "ADVSTORESHELL is capable of starting a process using CreateProcess.[11]"}, {"link": "https://attack.mitre.org/groups/G0067", "Name": "APT37", "Description": "APT37 leverages the Windows API calls: VirtualAlloc(), WriteProcessMemory(), and CreateRemoteThread() for process injection.[28]"}, {"link": "https://attack.mitre.org/software/S0128", "Name": "BADNEWS", "Description": "BADNEWS has a command to download an .exe and execute it via CreateProcess API. It can also run with ShellExecute.[13][14]"}, {"link": "https://attack.mitre.org/software/S0239", "Name": "Bankshot", "Description": "Bankshot creates processes using the Windows API calls: CreateProcessA() and CreateProcessAsUserA().[16]"}, {"link": "https://attack.mitre.org/software/S0154", "Name": "Cobalt Strike", "Description": "Cobalt Strike's \"beacon\" payload is capable of running shell commands without cmd.exe and PowerShell commands without powershell.exe[9]"}, {"link": "https://attack.mitre.org/software/S0363", "Name": "Empire", "Description": "Empire contains a variety of enumeration modules that have an option to use API calls to carry out tasks.[10]"}, {"link": "https://attack.mitre.org/groups/G0078", "Name": "Gorgon Group", "Description": "Gorgon Group malware can leverage the Windows API call, CreateProcessA(), for execution.[29]"}, {"link": "https://attack.mitre.org/software/S0391", "Name": "HAWKBALL", "Description": "HAWKBALL has leveraged several Windows API calls to create processes, gather disk information, and detect debugger activity.[24]"}, {"link": "https://attack.mitre.org/software/S0398", "Name": "HyperBro", "Description": "HyperBro has the ability to run an application (CreateProcessW) or script/file (ShellExecuteW) via API.[26]"}, {"link": "https://attack.mitre.org/software/S0259", "Name": "InnaputRAT", "Description": "InnaputRAT uses the API call ShellExecuteW for execution.[18]"}, {"link": "https://attack.mitre.org/software/S0395", "Name": "LightNeuron", "Description": "LightNeuron is capable of starting a process using CreateProcess.[25]"}, {"link": "https://attack.mitre.org/software/S0256", "Name": "Mosquito", "Description": "Mosquito leverages the CreateProcess() and LoadLibrary() calls to execute files with the .dll and .exe extensions.[19]"}, {"link": "https://attack.mitre.org/software/S0013", "Name": "PlugX", "Description": "PlugX can use the Windows API function CreateProcess to execute another process.[12]"}, {"link": "https://attack.mitre.org/software/S0416", "Name": "RDFSNIFFER", "Description": "RDFSNIFFER has used several Win32 API functions to interact with the victim machine.[27]"}, {"link": "https://attack.mitre.org/groups/G0091", "Name": "Silence", "Description": "Silence leverages the Windows API to perform a variety of tasks.   [30]"}, {"link": "https://attack.mitre.org/software/S0242", "Name": "SynAck", "Description": "SynAck parses the export tables of system DLLs to locate and call various Windows API functions.[21][22]"}, {"link": "https://attack.mitre.org/software/S0266", "Name": "TrickBot", "Description": "TrickBot uses the Windows API call, CreateProcessW(), to manage execution flow.[17]"}, {"link": "https://attack.mitre.org/groups/G0010", "Name": "Turla", "Description": "Turla and its RPC backdoors have used APIs calls for various tasks related to subverting AMSI and accessing then executing commands through RPC and/or named pipes.[31]"}, {"link": "https://attack.mitre.org/software/S0386", "Name": "Ursnif", "Description": "Ursnif has used CreateProcessW to create child processes.[23]"}, {"link": "https://attack.mitre.org/software/S0180", "Name": "Volgmer", "Description": "Volgmer executes payloads using the Windows API call CreateProcessW().[15]"}, {"link": "https://attack.mitre.org/software/S0161", "Name": "XAgentOSX", "Description": "XAgentOSX contains the execFile function to execute a specified file on the system using the NSTask:launch method.[20]"}, {"Mitigation": "Execution Prevention", "Description": "Identify and block potentially malicious software executed that may be executed through this technique by using application whitelisting tools, like Windows Defender Application Control, AppLocker, or Software Restriction Policies where appropriate.[3][4][5][6][7][8]"}]}