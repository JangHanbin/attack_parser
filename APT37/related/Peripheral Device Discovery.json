{"title": "Peripheral Device Discovery", "descrption": "\nAdversaries may attempt to gather information about attached peripheral devices and components connected to a computer system. The information may be used to enhance their awareness of the system and network environment or may be used for further actions.\n", "ID": "T1120", "Tactic": "Discovery", "Platform": "Windows, macOS", "Permissions Required": "User, Administrator, SYSTEM", "Data Sources": "PowerShell logs, API monitoring, Process monitoring, Process command-line parameters", "CAPEC ID": "CAPEC-646", "Version": "1.1", "Created": "31 May 2017", "Last Modified": "03 July 2019", "references": [{"index": 1, "title": "ESET. (2016, October). En Route with Sednit - Part 2: Observing the Comings and Goings. Retrieved November 21, 2016.", "external_link": "http://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-part-2.pdf"}, {"index": 2, "title": "Settle, A., et al. (2016, August 8). MONSOON - Analysis Of An APT Campaign. Retrieved September 22, 2016.", "external_link": "https://www.forcepoint.com/sites/default/files/resources/files/forcepoint-security-labs-monsoon-analysis-report.pdf"}, {"index": 3, "title": "Lunghi, D., et al. (2017, December). Untangling the Patchwork Cyberespionage Group. Retrieved July 10, 2018.", "external_link": "https://documents.trendmicro.com/assets/tech-brief-untangling-the-patchwork-cyberespionage-group.pdf"}, {"index": 4, "title": "Baumgartner, K. and Garnaeva, M.. (2014, November 3). BE2 custom plugins, router abuse, and target profiles. Retrieved March 24, 2016.", "external_link": "https://securelist.com/be2-custom-plugins-router-abuse-and-target-profiles/67353/"}, {"index": 5, "title": "Faou, M. and Boutin, J.. (2017, February). Read The Manual: A Guide to the RTM Banking Trojan. Retrieved March 9, 2017.", "external_link": "https://www.welivesecurity.com/wp-content/uploads/2017/02/Read-The-Manual.pdf"}, {"index": 6, "title": "Grunzweig, J. and Miller-Osborn, J.. (2016, February 4). T9000: Advanced Modular Backdoor Uses Complex Anti-Analysis Techniques. Retrieved April 15, 2016.", "external_link": "http://researchcenter.paloaltonetworks.com/2016/02/t9000-advanced-modular-backdoor-uses-complex-anti-analysis-techniques/"}, {"index": 7, "title": "Robert Falcone. (2017, February 14). XAgentOSX: Sofacy's Xagent macOS Tool. Retrieved July 12, 2017.", "external_link": "https://researchcenter.paloaltonetworks.com/2017/02/unit42-xagentosx-sofacys-xagent-macos-tool/"}, {"index": 8, "title": "Calvet, J. (2014, November 11). Sednit Espionage Group Attacking Air-Gapped Networks. Retrieved January 4, 2017.", "external_link": "http://www.welivesecurity.com/2014/11/11/sednit-espionage-group-attacking-air-gapped-networks/"}, {"index": 9, "title": "Falcone, R., Lee, B. (2018, November 20). Sofacy Continues Global Attacks and Wheels Out New \u2018Cannon\u2019 Trojan. Retrieved November 26, 2018.", "external_link": "https://researchcenter.paloaltonetworks.com/2018/11/unit42-sofacy-continues-global-attacks-wheels-new-cannon-trojan/"}, {"index": 10, "title": "Cherepanov, A.. (2016, May 17). Operation Groundbait: Analysis of a surveillance toolkit. Retrieved May 18, 2016.", "external_link": "http://www.welivesecurity.com/wp-content/uploads/2016/05/Operation-Groundbait.pdf"}, {"index": 11, "title": "Miller-Osborn, J. and Grunzweig, J.. (2017, March 30). Trochilus and New MoonWind RATs Used In Attack Against Thai Organizations. Retrieved March 30, 2017.", "external_link": "http://researchcenter.paloaltonetworks.com/2017/03/unit42-trochilus-rat-new-moonwind-rat-used-attack-thai-utility-organizations/"}, {"index": 12, "title": "Berry, A., Homan, J., and Eitzman, R. (2017, May 23). WannaCry Malware Profile. Retrieved March 15, 2019.", "external_link": "https://www.fireeye.com/blog/threat-research/2017/05/wannacry-malware-profile.html"}, {"index": 13, "title": "Kamluk, V. & Gostev, A. (2016, February). Adwind - A Cross-Platform RAT. Retrieved April 23, 2019.", "external_link": "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07195002/KL_AdwindPublicReport_2016.pdf"}, {"index": 14, "title": "Proofpoint Staff. (2018, March 7). Leaked Ammyy Admin Source Code Turned into Malware. Retrieved May 28, 2019.", "external_link": "https://www.proofpoint.com/us/threat-insight/post/leaked-ammyy-admin-source-code-turned-malware"}, {"index": 15, "title": "Fidelis Cybersecurity. (2013, June 28). Fidelis Threat Advisory #1009: \"njRAT\" Uncovered. Retrieved June 4, 2019.", "external_link": "https://www.threatminer.org/_reports/2013/fta-1009---njrat-uncovered-1.pdf"}, {"index": 16, "title": "ESET. (2019, July). MACHETE JUST GOT SHARPER Venezuelan government institutions under attack. Retrieved September 13, 2019.", "external_link": "https://www.welivesecurity.com/wp-content/uploads/2019/08/ESET_Machete.pdf"}, {"index": 17, "title": "Anthe, C. et al. (2015, October 19). Microsoft Security Intelligence Report Volume 19. Retrieved December 23, 2015.", "external_link": "http://download.microsoft.com/download/4/4/C/44CDEF0E-7924-4787-A56A-16261691ACE3/Microsoft_Security_Intelligence_Report_Volume_19_English.pdf"}, {"index": 18, "title": "Kasza, A. and Reichel, D.. (2017, February 27). The Gamaredon Group Toolset Evolution. Retrieved March 1, 2017.", "external_link": "https://researchcenter.paloaltonetworks.com/2017/02/unit-42-title-gamaredon-group-toolset-evolution/"}, {"index": 19, "title": "Kaspersky Lab's Global Research and Analysis Team. (2015, February). Equation Group: Questions and Answers. Retrieved December 21, 2015.", "external_link": "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/08064459/Equation_group_questions_and_answers.pdf"}, {"index": 20, "title": "GReAT. (2019, May 13). ScarCruft continues to evolve, introduces Bluetooth harvester. Retrieved June 4, 2019.", "external_link": "https://securelist.com/scarcruft-continues-to-evolve-introduces-bluetooth-harvester/90729/"}], "related": [{"link": "https://attack.mitre.org/software/S0045", "Name": "ADVSTORESHELL", "Description": "ADVSTORESHELL can list connected devices.[1]"}, {"link": "https://attack.mitre.org/groups/G0007", "Name": "APT28", "Description": "APT28 uses a module to receive a notification every time a USB mass storage device is inserted into a victim.[17]"}, {"link": "https://attack.mitre.org/groups/G0067", "Name": "APT37", "Description": "APT37 has a Bluetooth device harvester, which uses Windows Bluetooth APIs to find information on connected Bluetooth devices.[20]"}, {"link": "https://attack.mitre.org/software/S0128", "Name": "BADNEWS", "Description": "BADNEWS checks for new hard drives on the victim, such as USB devices, by listening for the WM_DEVICECHANGE window message.[2][3]"}, {"link": "https://attack.mitre.org/software/S0089", "Name": "BlackEnergy", "Description": "BlackEnergy can gather very specific information about attached USB devices, to include device instance ID and drive geometry.[4]"}, {"link": "https://attack.mitre.org/groups/G0020", "Name": "Equation", "Description": "Equation has used tools with the functionality to search for specific information about the attached hard drive that could be used to identify and overwrite the firmware.[19]"}, {"link": "https://attack.mitre.org/software/S0381", "Name": "FlawedAmmyy", "Description": "FlawedAmmyy will attempt to detect if a usable smart card is current inserted into a card reader.[14]"}, {"link": "https://attack.mitre.org/groups/G0047", "Name": "Gamaredon Group", "Description": "Gamaredon Group tools contained an application to check performance of USB flash drives.[18]"}, {"link": "https://attack.mitre.org/software/S0283", "Name": "jRAT", "Description": "jRAT can map UPnP ports.[13]"}, {"link": "https://attack.mitre.org/software/S0409", "Name": "Machete", "Description": "Machete detects the insertion of new devices by listening for the WM_DEVICECHANGE window message.  [16]"}, {"link": "https://attack.mitre.org/software/S0149", "Name": "MoonWind", "Description": "MoonWind obtains the number of removable drives from the victim.[11]"}, {"link": "https://attack.mitre.org/software/S0385", "Name": "njRAT", "Description": "njRAT will attempt to detect if the victim system has a camera during the initial infection.[15]"}, {"link": "https://attack.mitre.org/software/S0113", "Name": "Prikormka", "Description": "A module in Prikormka collects information on available printers and disk drives.[10]"}, {"link": "https://attack.mitre.org/software/S0148", "Name": "RTM", "Description": "RTM can obtain a list of smart card readers attached to the victim.[5]"}, {"link": "https://attack.mitre.org/software/S0098", "Name": "T9000", "Description": "T9000 searches through connected drives for removable storage devices.[6]"}, {"link": "https://attack.mitre.org/software/S0136", "Name": "USBStealer", "Description": "USBStealer monitors victims for insertion of removable drives. When dropped onto a second victim, it also enumerates drives connected to the system.[8]"}, {"link": "https://attack.mitre.org/software/S0366", "Name": "WannaCry", "Description": "WannaCry contains a thread that will attempt to scan for new attached drives every few seconds. If one is identified, it will encrypt the files on the attached device.[12]"}, {"link": "https://attack.mitre.org/software/S0161", "Name": "XAgentOSX", "Description": "XAgentOSX contains the showBackupIosFolder function to check for IOS device backups by running ls -la ~/Library/Application\\ Support/MobileSync/Backup/.[7]"}, {"link": "https://attack.mitre.org/software/S0251", "Name": "Zebrocy", "Description": "Zebrocy enumerates information about connected storage devices.[9]"}]}