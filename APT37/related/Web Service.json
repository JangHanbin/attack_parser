{"title": "Web Service", "descrption": "\nAdversaries may use an existing, legitimate external Web service as a means for relaying commands to a compromised system.These commands may also include pointers to command and control (C2) infrastructure. Adversaries may post content, known as a dead drop resolver, on Web services with embedded (and often obfuscated/encoded) domains or IP addresses. Once infected, victims will reach out to and be redirected by these resolvers.Popular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.Use of Web services may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).\n", "ID": "T1102", "Tactic": "Command And Control,                                                Defense Evasion", "Platform": "Linux, macOS, Windows", "Permissions Required": "User", "Data Sources": "Host network interface, Netflow/Enclave netflow, Network protocol analysis, Packet capture, SSL/TLS inspection", "Requires Network": "Yes", "Defense Bypassed": "Binary Analysis, Log analysis, Firewall", "Contributors": "Anastasios Pingios", "Version": "1.0", "Created": "31 May 2017", "Last Modified": "18 July 2019", "references": [{"index": 1, "title": "Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.", "external_link": "https://github.com/PowerShellEmpire/Empire"}, {"index": 2, "title": "FireEye Labs. (2015, July). HAMMERTOSS: Stealthy Tactics Define a Russian Cyber Threat Group. Retrieved September 17, 2015.", "external_link": "https://www2.fireeye.com/rs/848-DID-242/images/rpt-apt29-hammertoss.pdf"}, {"index": 3, "title": "Grunzweig, J. (2018, January 31). Comnie Continues to Target Organizations in East Asia. Retrieved June 7, 2018.", "external_link": "https://researchcenter.paloaltonetworks.com/2018/01/unit42-comnie-continues-target-organizations-east-asia/"}, {"index": 4, "title": "Levene, B, et al. (2017, May 03). Kazuar: Multiplatform Espionage Backdoor with API Access. Retrieved July 17, 2018.", "external_link": "https://researchcenter.paloaltonetworks.com/2017/05/unit42-kazuar-multiplatform-espionage-backdoor-api-access/"}, {"index": 5, "title": "F-Secure Labs. (2015, April 22). CozyDuke: Malware Analysis. Retrieved December 10, 2015.", "external_link": "https://www.f-secure.com/documents/996508/1030745/CozyDuke"}, {"index": 6, "title": "Mandiant. (n.d.). APT1 Exposing One of China\u2019s Cyber Espionage Units. Retrieved July 18, 2016.", "external_link": "https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/mandiant-apt1-report.pdf"}, {"index": 7, "title": "CyberESI. (2011). TROJAN.GTALK. Retrieved June 29, 2015.", "external_link": "http://www.cyberengineeringservices.com/2011/12/15/trojan-gtalk/"}, {"index": 8, "title": "F-Secure Labs. (2015, September 17). The Dukes: 7 years of Russian cyberespionage. Retrieved December 10, 2015.", "external_link": "https://www.f-secure.com/documents/996508/1030745/dukes_whitepaper.pdf"}, {"index": 9, "title": "Kaspersky Lab's Global Research & Analysis Team. (2013, February 27). The MiniDuke Mystery: PDF 0-day Government Spy Assembler 0x29A Micro Backdoor. Retrieved April 5, 2017.", "external_link": "https://cdn.securelist.com/files/2014/07/themysteryofthepdf0-dayassemblermicrobackdoor.pdf"}, {"index": 10, "title": "FireEye. (2018, February 20). APT37 (Reaper): The Overlooked North Korean Actor. Retrieved March 1, 2018.", "external_link": "https://www2.fireeye.com/rs/848-DID-242/images/rpt_APT37.pdf"}, {"index": 11, "title": "Mercer, W., Rascagneres, P. (2017, April 03). Introducing ROKRAT. Retrieved May 21, 2018.", "external_link": "https://blog.talosintelligence.com/2017/04/introducing-rokrat.html"}, {"index": 12, "title": "GReAT. (2019, May 13). ScarCruft continues to evolve, introduces Bluetooth harvester. Retrieved June 4, 2019.", "external_link": "https://securelist.com/scarcruft-continues-to-evolve-introduces-bluetooth-harvester/90729/"}, {"index": 13, "title": "Grunzweig, J. (2018, October 01). NOKKI Almost Ties the Knot with DOGCALL: Reaper Group Uses New Malware to Deploy RAT. Retrieved November 5, 2018.", "external_link": "https://researchcenter.paloaltonetworks.com/2018/10/unit42-nokki-almost-ties-the-knot-with-dogcall-reaper-group-uses-new-malware-to-deploy-rat/"}, {"index": 14, "title": "FireEye Threat Intelligence. (2015, December 1). China-based Cyber Threat Group Uses Dropbox for Malware Communications and Targets Hong Kong Media Outlets. Retrieved December 4, 2015.", "external_link": "https://www.fireeye.com/blog/threat-research/2015/11/china-based-threat.html"}, {"index": 15, "title": "FireEye Labs/FireEye Threat Intelligence. (2015, May 14). Hiding in Plain Sight: FireEye and Microsoft Expose Obfuscation Tactic. Retrieved January 22, 2016.", "external_link": "https://www2.fireeye.com/rs/fireye/images/APT17_Report.pdf"}, {"index": 16, "title": "FireEye. (2018, March 16). Suspected Chinese Cyber Espionage Group (TEMP.Periscope) Targeting U.S. Engineering and Maritime Industries. Retrieved April 11, 2018.", "external_link": "https://www.fireeye.com/blog/threat-research/2018/03/suspected-chinese-espionage-group-targeting-maritime-and-engineering-industries.html"}, {"index": 17, "title": "Settle, A., et al. (2016, August 8). MONSOON - Analysis Of An APT Campaign. Retrieved September 22, 2016.", "external_link": "https://www.forcepoint.com/sites/default/files/resources/files/forcepoint-security-labs-monsoon-analysis-report.pdf"}, {"index": 18, "title": "Levene, B. et al.. (2018, March 7). Patchwork Continues to Deliver BADNEWS to the Indian Subcontinent. Retrieved March 31, 2018.", "external_link": "https://researchcenter.paloaltonetworks.com/2018/03/unit42-patchwork-continues-deliver-badnews-indian-subcontinent/"}, {"index": 19, "title": "Lunghi, D., et al. (2017, December). Untangling the Patchwork Cyberespionage Group. Retrieved July 10, 2018.", "external_link": "https://documents.trendmicro.com/assets/tech-brief-untangling-the-patchwork-cyberespionage-group.pdf"}, {"index": 20, "title": "ESET. (2016, August 24). First Twitter-controlled Android botnet discovered. Retrieved December 22, 2016.", "external_link": "http://www.welivesecurity.com/2016/08/24/first-twitter-controlled-android-botnet-discovered/"}, {"index": 21, "title": "Hayashi, K. (2017, November 28). UBoatRAT Navigates East Asia. Retrieved January 12, 2018.", "external_link": "https://researchcenter.paloaltonetworks.com/2017/11/unit42-uboatrat-navigates-east-asia/"}, {"index": 22, "title": "Schwarz, D., Sopko J. (2018, March 08). Donot Team Leverages New Modular Malware Framework in South Asia. Retrieved June 11, 2018.", "external_link": "https://www.arbornetworks.com/blog/asert/donot-team-leverages-new-modular-malware-framework-south-asia/"}, {"index": 23, "title": "Mandiant. (n.d.). Appendix C (Digital) - The Malware Arsenal. Retrieved July 18, 2016.", "external_link": "https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/mandiant-apt1-report-appendix.zip"}, {"index": 24, "title": "Lancaster, T. and Idrizovic, E.. (2017, June 27). Paranoid PlugX. Retrieved July 13, 2017.", "external_link": "https://researchcenter.paloaltonetworks.com/2017/06/unit42-paranoid-plugx/"}, {"index": 25, "title": "Axel F, Pierre T. (2017, October 16). Leviathan: Espionage actor spearphishes maritime and defense targets. Retrieved February 15, 2018.", "external_link": "https://www.proofpoint.com/us/threat-insight/post/leviathan-espionage-actor-spearphishes-maritime-and-defense-targets"}, {"index": 26, "title": "Xiao, C. (2018, September 17). Xbash Combines Botnet, Ransomware, Coinmining in Worm that Targets Linux and Windows. Retrieved November 14, 2018.", "external_link": "https://researchcenter.paloaltonetworks.com/2018/09/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/"}, {"index": 27, "title": "Lee, B., Falcone, R. (2019, January 18). DarkHydrus delivers new Trojan that can use Google Drive for C2 communications. Retrieved April 17, 2019.", "external_link": "https://unit42.paloaltonetworks.com/darkhydrus-delivers-new-trojan-that-can-use-google-drive-for-c2-communications/"}, {"index": 28, "title": "Gannon, M. (2019, February 11). With Upgrades in Delivery and Support Infrastructure, Revenge RAT Malware is a Bigger Threat. Retrieved May 1, 2019.", "external_link": "https://cofense.com/upgrades-delivery-support-infrastructure-revenge-rat-malware-bigger-threat/"}, {"index": 29, "title": "Faou, M. and Dumont R.. (2019, May 29). A dive into Turla PowerShell usage. Retrieved June 14, 2019.", "external_link": "https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/"}, {"index": 30, "title": "Faou, M. and Boutin, J.. (2017, February). Read The Manual: A Guide to the RTM Banking Trojan. Retrieved March 9, 2017.", "external_link": "https://www.welivesecurity.com/wp-content/uploads/2017/02/Read-The-Manual.pdf"}, {"index": 31, "title": "Counter Threat Unit Research Team. (2017, October 12). BRONZE BUTLER Targets Japanese Enterprises. Retrieved January 4, 2018.", "external_link": "https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses"}, {"index": 32, "title": "ESET, et al. (2018, January). Diplomats in Eastern Europe bitten by a Turla mosquito. Retrieved July 3, 2018.", "external_link": "https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf"}, {"index": 33, "title": "ESET Research. (2018, May 22). Turla Mosquito: A shift towards more generic tools. Retrieved July 3, 2018.", "external_link": "https://www.welivesecurity.com/2018/05/22/turla-mosquito-shift-towards-generic-tools/"}, {"index": 34, "title": "Griffin, N. (2017, January 17). CARBANAK GROUP USES GOOGLE FOR MALWARE COMMAND-AND-CONTROL. Retrieved February 15, 2017.", "external_link": "https://blogs.forcepoint.com/security-labs/carbanak-group-uses-google-malware-command-and-control"}, {"index": 35, "title": "Carr, N., et al. (2018, August 01). On the Hunt for FIN7: Pursuing an Enigmatic and Evasive Global Criminal Operation. Retrieved August 23, 2018.", "external_link": "https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html"}, {"index": 36, "title": "Mercer, W., Rascagneres, P. (2018, January 16). Korea In The Crosshairs. Retrieved May 21, 2018.", "external_link": "https://blog.talosintelligence.com/2018/01/korea-in-crosshairs.html"}, {"index": 37, "title": "Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017.", "external_link": "https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/"}, {"index": 38, "title": "Kaspersky Lab's Global Research & Analysis Team. (2016, July 8). The Dropping Elephant \u2013 aggressive cyber-espionage in the Asian region. Retrieved August 3, 2016.", "external_link": "https://securelist.com/the-dropping-elephant-actor/75328/"}, {"index": 39, "title": "McKeague, B. et al. (2019, April 5). Pick-Six: Intercepting a FIN6 Intrusion, an Actor Recently Tied to Ryuk and LockerGoga Ransomware. Retrieved April 17, 2019.", "external_link": "https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html"}, {"index": 40, "title": "Meyers, A. (2013, March 29). Whois Numbered Panda. Retrieved January 14, 2016.", "external_link": "http://www.crowdstrike.com/blog/whois-numbered-panda/"}, {"index": 41, "title": "Fraser, N., et al. (2019, August 7). Double DragonAPT41, a dual espionage and cyber crime operation APT41. Retrieved September 23, 2019.", "external_link": "https://content.fireeye.com/apt-41/rpt-apt41"}, {"index": 42, "title": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", "external_link": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"}], "related": [{"link": "https://attack.mitre.org/groups/G0005", "Name": "APT12", "Description": "APT12 has used blogs and WordPress for C2 infrastructure.[40]"}, {"link": "https://attack.mitre.org/groups/G0067", "Name": "APT37", "Description": "APT37 leverages social networking sites and cloud platforms (AOL, Twitter, Yandex, Mediafire, pCloud, Dropbox, and Box) for C2.[10][36]"}, {"link": "https://attack.mitre.org/groups/G0096", "Name": "APT41", "Description": "APT41 used legitimate websites for C2 through dead drop resolvers (DDR), including GitHub, Pastebin, and Microsoft TechNet.[41]"}, {"link": "https://attack.mitre.org/software/S0128", "Name": "BADNEWS", "Description": "BADNEWS can use multiple C2 channels, including RSS feeds, Github, forums, and blogs. BADNEWS also collects C2 information via a dead drop resolver.[17][18][19]"}, {"link": "https://attack.mitre.org/software/S0069", "Name": "BLACKCOFFEE", "Description": "BLACKCOFFEE uses Microsoft\u2019s TechNet Web portal to obtain a dead drop resolver containing an encoded tag with the IP address of a command and control server. It has also obfuscated its C2 traffic as normal traffic to sites such as Github.[15][16]"}, {"link": "https://attack.mitre.org/groups/G0060", "Name": "BRONZE BUTLER", "Description": "BRONZE BUTLER's MSGET downloader uses a dead drop resolver to access malicious payloads.[31]"}, {"link": "https://attack.mitre.org/software/S0025", "Name": "CALENDAR", "Description": "The CALENDAR malware communicates through the use of events in Google Calendar.[6][23]"}, {"link": "https://attack.mitre.org/groups/G0008", "Name": "Carbanak", "Description": "Carbanak has used a VBScript named \"ggldr\" that uses Google Apps Script, Sheets, and Forms services for C2.[34]"}, {"link": "https://attack.mitre.org/software/S0054", "Name": "CloudDuke", "Description": "One variant of CloudDuke uses a Microsoft OneDrive account to exchange commands and stolen data with its operators.[8]"}, {"link": "https://attack.mitre.org/software/S0244", "Name": "Comnie", "Description": "Comnie uses blogs and third-party sites (GitHub, tumbler, and BlogSpot) to avoid DNS-based blocking of their communication to the command and control server.[3]"}, {"link": "https://attack.mitre.org/software/S0046", "Name": "CozyCar", "Description": "CozyCar uses Twitter as a backup C2 channel to Twitter accounts specified in its configuration file.[5]"}, {"link": "https://attack.mitre.org/software/S0213", "Name": "DOGCALL", "Description": "DOGCALL is capable of leveraging cloud storage APIs such as Cloud, Box, Dropbox, and Yandex for C2.[10][13]"}, {"link": "https://attack.mitre.org/software/S0363", "Name": "Empire", "Description": "Empire can use Dropbox and GitHub for C2.[1]"}, {"link": "https://attack.mitre.org/groups/G0037", "Name": "FIN6", "Description": "FIN6 has used Pastebin to host content for the operation.[39]"}, {"link": "https://attack.mitre.org/groups/G0046", "Name": "FIN7", "Description": "FIN7 used legitimate services like Google Docs, Google Scripts, and Pastebin for C2.[35]"}, {"link": "https://attack.mitre.org/software/S0026", "Name": "GLOOXMAIL", "Description": "GLOOXMAIL communicates to servers operated by Google using the Jabber/XMPP protocol.[6][7]"}, {"link": "https://attack.mitre.org/software/S0037", "Name": "HAMMERTOSS", "Description": "The \"tDiscoverer\" variant of HAMMERTOSS establishes a C2 channel by downloading resources from Web services like Twitter and GitHub. HAMMERTOSS binaries contain an algorithm that generates a different Twitter handle for the malware to check for instructions every day.[2]"}, {"link": "https://attack.mitre.org/software/S0215", "Name": "KARAE", "Description": "KARAE can use public cloud-based storage providers for command and control.[10]"}, {"link": "https://attack.mitre.org/software/S0265", "Name": "Kazuar", "Description": "Kazuar has used compromised WordPress blogs as C2 servers.[4]"}, {"link": "https://attack.mitre.org/groups/G0065", "Name": "Leviathan", "Description": "Leviathan has received C2 instructions from user profiles created on legitimate websites such as Github and TechNet.[16]"}, {"link": "https://attack.mitre.org/software/S0042", "Name": "LOWBALL", "Description": "LOWBALL uses the Dropbox cloud storage service for command and control.[14]"}, {"link": "https://attack.mitre.org/groups/G0059", "Name": "Magic Hound", "Description": "Magic Hound malware can use a SOAP Web service to communicate with its C2 server.[37]"}, {"link": "https://attack.mitre.org/software/S0051", "Name": "MiniDuke", "Description": "Some MiniDuke components use Twitter to initially obtain the address of a C2 server or as a backup if no hard-coded C2 server responds.[8][9]"}, {"link": "https://attack.mitre.org/software/S0052", "Name": "OnionDuke", "Description": "OnionDuke uses Twitter as a backup C2 method. It also has a module designed to post messages to the Russian VKontakte social media site.[8]"}, {"link": "https://attack.mitre.org/software/S0229", "Name": "Orz", "Description": "Orz has used Technet and Pastebin web pages for command and control.[25]"}, {"link": "https://attack.mitre.org/groups/G0040", "Name": "Patchwork", "Description": "Patchwork hides base64-encoded and encrypted C2 server locations in comments on legitimate websites.[38]"}, {"link": "https://attack.mitre.org/software/S0013", "Name": "PlugX", "Description": "PlugX uses Pastebin to store C2 addresses.[24]"}, {"link": "https://attack.mitre.org/software/S0216", "Name": "POORAIM", "Description": "POORAIM has used AOL Instant Messenger for C2.[10]"}, {"link": "https://attack.mitre.org/software/S0393", "Name": "PowerStallion", "Description": "PowerStallion uses Microsoft OneDrive as a C2 server via a network drive mapped with net use.[29]"}, {"link": "https://attack.mitre.org/software/S0379", "Name": "Revenge RAT", "Description": "Revenge RAT used blogpost.com as its primary command and control server during a campaign.[28]"}, {"link": "https://attack.mitre.org/software/S0270", "Name": "RogueRobin", "Description": "RogueRobin has used Google Drive as a Command and Control channel.[27]"}, {"link": "https://attack.mitre.org/software/S0240", "Name": "ROKRAT", "Description": "ROKRAT leverages legitimate social networking sites and cloud platforms (Twitter, Yandex, and Mediafire) for command and control communications.[11][12]"}, {"link": "https://attack.mitre.org/groups/G0048", "Name": "RTM", "Description": "RTM has used an RSS feed on Livejournal to update a list of encrypted C2 server names.[30]"}, {"link": "https://attack.mitre.org/software/S0218", "Name": "SLOWDRIFT", "Description": "SLOWDRIFT uses cloud based services for C2.[10]"}, {"link": "https://attack.mitre.org/groups/G0010", "Name": "Turla", "Description": "A Turla JavaScript backdoor has used Google Apps Script as its C2 server.[32][33]"}, {"link": "https://attack.mitre.org/software/S0302", "Name": "Twitoor", "Description": "Twitoor uses Twitter for command and control.[20]"}, {"link": "https://attack.mitre.org/software/S0333", "Name": "UBoatRAT", "Description": "UBoatRAT has used GitHub and a public blog service in Hong Kong for C2 communications.[21]"}, {"link": "https://attack.mitre.org/software/S0341", "Name": "Xbash", "Description": "Xbash can obtain a webpage hosted on Pastebin to update its C2 domain list.[26]"}, {"link": "https://attack.mitre.org/software/S0248", "Name": "yty", "Description": "yty communicates to the C2 server by retrieving a Google Doc.[22]"}, {"Mitigation": "Network Intrusion Prevention", "Description": "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level."}, {"Mitigation": "Restrict Web-Based Content", "Description": "Web proxies can be used to enforce external network communication policy that prevents use of unauthorized external services."}]}