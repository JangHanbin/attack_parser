{"title": "Bypass User Account Control", "descrption": "\nWindows User Account Control (UAC) allows a program to elevate its privileges to perform a task under administrator-level permissions by prompting the user for confirmation. The impact to the user ranges from denying the operation under high enforcement to allowing the user to perform the action if they are in the local administrators group and click through the prompt or allowing them to enter an administrator password to complete the action. [1]If the UAC protection level of a computer is set to anything but the highest level, certain Windows programs are allowed to elevate privileges or execute some elevated COM objects without prompting the user through the UAC notification box. [2] [3] An example of this is use of rundll32.exe to load a specifically crafted DLL which loads an auto-elevated COM object and performs a file operation in a protected directory which would typically require elevated access. Malicious software may also be injected into a trusted process to gain elevated privileges without prompting a user. [4] Adversaries can use these techniques to elevate privileges to administrator if the target process is unprotected.Many methods have been discovered to bypass UAC. The Github readme page for UACMe contains an extensive list of methods [5] that have been discovered and implemented within UACMe, but may not be a comprehensive list of bypasses. Additional bypass methods are regularly discovered and some used in the wild, such as:eventvwr.exe can auto-elevate and execute a specified binary or script. [6] [7]Another bypass is possible through some Lateral Movement techniques if credentials for an account with administrator privileges are known, since UAC is a single system security mechanism, and the privilege or integrity of a process running on one system will be unknown on lateral systems and default to high integrity. [8]\n", "ID": "T1088", "Tactic": "Defense Evasion,                                                Privilege Escalation", "Platform": "Windows", "Permissions Required": "User, Administrator", "Effective Permissions": "Administrator", "Data Sources": "System calls, Process monitoring, Authentication logs, Process command-line parameters", "Defense Bypassed": "Windows User Account Control", "Contributors": "Stefan Kanthak; Casey Smith", "Version": "1.0", "Created": "31 May 2017", "Last Modified": "16 July 2019", "references": [{"index": 1, "title": "Lich, B. (2016, May 31). How User Account Control Works. Retrieved June 3, 2016.", "external_link": "https://technet.microsoft.com/en-us/itpro/windows/keep-secure/how-user-account-control-works"}, {"index": 2, "title": "Russinovich, M. (2009, July). User Account Control: Inside Windows 7 User Account Control. Retrieved July 26, 2016.", "external_link": "https://technet.microsoft.com/en-US/magazine/2009.07.uac.aspx"}, {"index": 3, "title": "Microsoft. (n.d.). The COM Elevation Moniker. Retrieved July 26, 2016.", "external_link": "https://msdn.microsoft.com/en-us/library/ms679687.aspx"}, {"index": 4, "title": "Davidson, L. (n.d.). Windows 7 UAC whitelist. Retrieved November 12, 2014.", "external_link": "http://www.pretentiousname.com/misc/win7_uac_whitelist2.html"}, {"index": 5, "title": "UACME Project. (2016, June 16). UACMe. Retrieved July 26, 2016.", "external_link": "https://github.com/hfiref0x/UACME"}, {"index": 6, "title": "Nelson, M. (2016, August 15). \"Fileless\" UAC Bypass using eventvwr.exe and Registry Hijacking. Retrieved December 27, 2016.", "external_link": "https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/"}, {"index": 7, "title": "Salvio, J., Joven, R. (2016, December 16). Malicious Macro Bypasses UAC to Elevate Privilege for Fareit Malware. Retrieved December 27, 2016.", "external_link": "https://blog.fortinet.com/2016/12/16/malicious-macro-bypasses-uac-to-elevate-privilege-for-fareit-malware"}, {"index": 8, "title": "Medin, T. (2013, August 8). PsExec UAC Bypass. Retrieved June 3, 2016.", "external_link": "http://pen-testing.sans.org/blog/pen-testing/2013/08/08/psexec-uac-bypass"}, {"index": 9, "title": "Nicolas Verdier. (n.d.). Retrieved January 29, 2018.", "external_link": "https://github.com/n1nj4sec/pupy"}, {"index": 10, "title": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "external_link": "https://cobaltstrike.com/downloads/csmanual38.pdf"}, {"index": 11, "title": "Bacurio, F., Salvio, J. (2017, February 14). REMCOS: A New RAT In The Wild. Retrieved November 6, 2018.", "external_link": "https://www.fortinet.com/blog/threat-research/remcos-a-new-rat-in-the-wild-2.html"}, {"index": 12, "title": "Magius, J., et al. (2017, July 19). Koadic. Retrieved June 18, 2018.", "external_link": "https://github.com/zerosum0x0/koadic"}, {"index": 13, "title": "Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.", "external_link": "https://github.com/PowerShellEmpire/Empire"}, {"index": 14, "title": "Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.", "external_link": "https://github.com/nettitude/PoshC2_Python"}, {"index": 15, "title": "Falcone, R.. (2016, November 30). Shamoon 2: Return of the Disttrack Wiper. Retrieved January 11, 2017.", "external_link": "http://researchcenter.paloaltonetworks.com/2016/11/unit42-shamoon-2-return-disttrack-wiper/"}, {"index": 16, "title": "ESET. (2016, October). En Route with Sednit - Part 3: A Mysterious Downloader. Retrieved November 21, 2016.", "external_link": "http://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-part3.pdf"}, {"index": 17, "title": "Settle, A., et al. (2016, August 8). MONSOON - Analysis Of An APT Campaign. Retrieved September 22, 2016.", "external_link": "https://www.forcepoint.com/sites/default/files/resources/files/forcepoint-security-labs-monsoon-analysis-report.pdf"}, {"index": 18, "title": "F-Secure Labs. (2014). BlackEnergy & Quedagh: The convergence of crimeware and APT attacks. Retrieved March 24, 2016.", "external_link": "https://www.f-secure.com/documents/996508/1030745/blackenergy_whitepaper.pdf"}, {"index": 19, "title": "Ash, B., et al. (2018, June 26). RANCOR: Targeted Attacks in South East Asia Using PLAINTEE and DDKONG Malware Families. Retrieved July 2, 2018.", "external_link": "https://researchcenter.paloaltonetworks.com/2018/06/unit42-rancor-targeted-attacks-south-east-asia-using-plaintee-ddkong-malware-families/"}, {"index": 20, "title": "Hromcov\u00e1, Z. (2018, June 07). InvisiMole: Surprisingly equipped spyware, undercover since 2013. Retrieved July 10, 2018.", "external_link": "https://www.welivesecurity.com/2018/06/07/invisimole-equipped-spyware-undercover/"}, {"index": 21, "title": "Huss, D., et al. (2017, February 2). Oops, they did it again: APT Targets Russia and Belarus with ZeroT and PlugX. Retrieved April 5, 2018.", "external_link": "https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx"}, {"index": 22, "title": "FinFisher. (n.d.). Retrieved December 20, 2017.", "external_link": "http://www.finfisher.com/FinFisher/index.html"}, {"index": 23, "title": "Allievi, A.,Flori, E. (2018, March 01). FinFisher exposed: A researcher\u2019s tale of defeating traps, tricks, and complex virtual machines. Retrieved July 9, 2018.", "external_link": "https://cloudblogs.microsoft.com/microsoftsecure/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/"}, {"index": 24, "title": "Faou, M. and Boutin, J.. (2017, February). Read The Manual: A Guide to the RTM Banking Trojan. Retrieved March 9, 2017.", "external_link": "https://www.welivesecurity.com/wp-content/uploads/2017/02/Read-The-Manual.pdf"}, {"index": 25, "title": "Reynolds, J.. (2016, September 14). H1N1: Technical analysis reveals new capabilities \u2013 part 2. Retrieved September 26, 2016.", "external_link": "http://blogs.cisco.com/security/h1n1-technical-analysis-reveals-new-capabilities-part-2"}, {"index": 26, "title": "Dell SecureWorks Counter Threat Unit Threat Intelligence. (2015, July 30). Sakula Malware Family. Retrieved January 26, 2016.", "external_link": "http://www.secureworks.com/cyber-threat-intelligence/threats/sakula-malware-family/"}, {"index": 27, "title": "Sherstobitoff, R. (2018, March 02). McAfee Uncovers Operation Honeybee, a Malicious Document Campaign Targeting Humanitarian Aid Groups. Retrieved May 16, 2018.", "external_link": "https://securingtomorrow.mcafee.com/mcafee-labs/mcafee-uncovers-operation-honeybee-malicious-document-campaign-targeting-humanitarian-aid-groups/"}, {"index": 28, "title": "Counter Threat Unit Research Team. (2017, October 12). BRONZE BUTLER Targets Japanese Enterprises. Retrieved January 4, 2018.", "external_link": "https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses"}, {"index": 29, "title": "Dunwoody, M. and Carr, N.. (2016, September 27). No Easy Breach DerbyCon 2016. Retrieved October 4, 2016.", "external_link": "http://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016"}, {"index": 30, "title": "Matveeva, V. (2017, August 15). Secrets of Cobalt. Retrieved October 10, 2018.", "external_link": "https://www.group-ib.com/blog/cobalt"}, {"index": 31, "title": "ClearSky Cyber Security. (2018, November). MuddyWater Operations in Lebanon and Oman: Using an Israeli compromised domain for a two-stage campaign. Retrieved November 29, 2018.", "external_link": "https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf"}, {"index": 32, "title": "Pantazopoulos, N., Henry T. (2018, May 18). Emissary Panda \u2013 A potential new malicious tool. Retrieved June 25, 2018.", "external_link": "https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/may/emissary-panda-a-potential-new-malicious-tool/"}, {"index": 33, "title": "Cymmetria. (2016). Unveiling Patchwork - The Copy-Paste APT. Retrieved August 3, 2016.", "external_link": "https://s3-us-west-2.amazonaws.com/cymmetria-blog/public/Unveiling_Patchwork.pdf"}, {"index": 34, "title": "GReAT. (2019, May 13). ScarCruft continues to evolve, introduces Bluetooth harvester. Retrieved June 4, 2019.", "external_link": "https://securelist.com/scarcruft-continues-to-evolve-introduces-bluetooth-harvester/90729/"}, {"index": 35, "title": "Nelson, M. (2017, March 14). Bypassing UAC using App Paths. Retrieved May 25, 2017.", "external_link": "https://enigma0x3.net/2017/03/14/bypassing-uac-using-app-paths/"}, {"index": 36, "title": "Nelson, M. (2017, March 17). \"Fileless\" UAC Bypass Using sdclt.exe. Retrieved May 25, 2017.", "external_link": "https://enigma0x3.net/2017/03/17/fileless-uac-bypass-using-sdclt-exe/"}], "related": [{"link": "https://attack.mitre.org/groups/G0016", "Name": "APT29", "Description": "APT29 has bypassed UAC.[29]"}, {"link": "https://attack.mitre.org/groups/G0067", "Name": "APT37", "Description": "APT37 has a function in the initial dropper to bypass Windows UAC in order to execute the next payload with higher privileges.[34]"}, {"link": "https://attack.mitre.org/software/S0129", "Name": "AutoIt backdoor", "Description": "AutoIt backdoor attempts to escalate privileges by bypassing User Access Control.[17]"}, {"link": "https://attack.mitre.org/software/S0089", "Name": "BlackEnergy", "Description": "BlackEnergy attempts to bypass default User Access Control (UAC) settings by exploiting a backward-compatibility setting found in Windows 7 and later.[18]"}, {"link": "https://attack.mitre.org/groups/G0060", "Name": "BRONZE BUTLER", "Description": "BRONZE BUTLER malware xxmm contains a UAC bypass tool for privilege escalation.[28]"}, {"link": "https://attack.mitre.org/groups/G0080", "Name": "Cobalt Group", "Description": "Cobalt Group has bypassed UAC.[30]"}, {"link": "https://attack.mitre.org/software/S0154", "Name": "Cobalt Strike", "Description": "Cobalt Strike can use a number of known techniques to bypass Windows UAC.[10]"}, {"link": "https://attack.mitre.org/software/S0134", "Name": "Downdelph", "Description": "Downdelph bypasses UAC to escalate privileges by using a custom \"RedirectEXE\" shim database.[16]"}, {"link": "https://attack.mitre.org/software/S0363", "Name": "Empire", "Description": "Empire includes various modules to attempt to bypass UAC for escalation of privileges.[13]"}, {"link": "https://attack.mitre.org/software/S0182", "Name": "FinFisher", "Description": "FinFisher performs UAC bypass.[22][23]"}, {"link": "https://attack.mitre.org/software/S0132", "Name": "H1N1", "Description": "H1N1 bypasses user access control by using a DLL hijacking vulnerability in the Windows Update Standalone Installer (wusa.exe).[25]"}, {"link": "https://attack.mitre.org/groups/G0072", "Name": "Honeybee", "Description": "Honeybee uses a combination of NTWDBLIB.dll and cliconfg.exe to bypass UAC protections using DLL hijacking.[27]"}, {"link": "https://attack.mitre.org/software/S0260", "Name": "InvisiMole", "Description": "InvisiMole can bypass UAC and create an elevated COM object to escalate privileges.[20]"}, {"link": "https://attack.mitre.org/software/S0250", "Name": "Koadic", "Description": "Koadic has 2 methods for elevating integrity. It can bypass UAC through eventvwr.exe and sdclt.exe.[12]"}, {"link": "https://attack.mitre.org/groups/G0069", "Name": "MuddyWater", "Description": "MuddyWater uses various techniques to bypass UAC.[31]"}, {"link": "https://attack.mitre.org/groups/G0040", "Name": "Patchwork", "Description": "Patchwork bypassed User Access Control (UAC).[33]"}, {"link": "https://attack.mitre.org/software/S0254", "Name": "PLAINTEE", "Description": "An older variant of PLAINTEE performs UAC bypass.[19]"}, {"link": "https://attack.mitre.org/software/S0378", "Name": "PoshC2", "Description": "PoshC2 can utilize multiple methods to bypass UAC.[14]"}, {"link": "https://attack.mitre.org/software/S0192", "Name": "Pupy", "Description": "Pupy can bypass Windows UAC through either DLL hijacking, eventvwr, or appPaths.[9]"}, {"link": "https://attack.mitre.org/software/S0332", "Name": "Remcos", "Description": "Remcos has a command for UAC bypassing.[11]"}, {"link": "https://attack.mitre.org/software/S0148", "Name": "RTM", "Description": "RTM can attempt to run the program as admin, then show a fake error message and a legitimate UAC bypass prompt to the user in an attempt to socially engineer the user into escalating privileges.[24]"}, {"link": "https://attack.mitre.org/software/S0074", "Name": "Sakula", "Description": "Sakula contains UAC bypass code for both 32- and 64-bit systems.[26]"}, {"link": "https://attack.mitre.org/software/S0140", "Name": "Shamoon", "Description": "Shamoon attempts to disable UAC remote restrictions by modifying the Registry.[15]"}, {"link": "https://attack.mitre.org/groups/G0027", "Name": "Threat Group-3390", "Description": "A Threat Group-3390 tool can use a public UAC bypass method to elevate privileges.[32]"}, {"link": "https://attack.mitre.org/software/S0116", "Name": "UACMe", "Description": "UACMe contains many methods for bypassing Windows User Account Control on multiple versions of the operating system.[5]"}, {"link": "https://attack.mitre.org/software/S0230", "Name": "ZeroT", "Description": "Many ZeroT samples can perform UAC bypass by using eventvwr.exe to execute a malicious file.[21]"}, {"Mitigation": "Audit", "Description": "Check for common UAC bypass weaknesses on Windows systems to be aware of the risk posture and address issues where appropriate."}, {"Mitigation": "Privileged Account Management", "Description": "Remove users from the local administrator group on systems."}, {"Mitigation": "User Account Control", "Description": "Although UAC bypass techniques exist, it is still prudent to use the highest enforcement level for UAC when possible and mitigate bypass opportunities that exist with techniques such as DLL Search Order Hijacking."}]}