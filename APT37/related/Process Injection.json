{"title": "Process Injection", "descrption": "\nProcess injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process.WindowsThere are multiple approaches to injecting code into a live process. Windows implementations include: [1]Dynamic-link library (DLL) injection involves writing the path to a malicious DLL inside a process then invoking execution by creating a remote thread.Portable executable injection involves writing malicious code directly into the process (without a file on disk) then invoking execution with either additional code or by creating a remote thread. The displacement of the injected code introduces the additional requirement for functionality to remap memory references. Variations of this method such as reflective DLL injection (writing a self-mapping DLL into a process) and memory module (map DLL when writing into process) overcome the address relocation issue. [2]Thread execution hijacking involves injecting malicious code or the path to a DLL into a thread of a process. Similar to Process Hollowing, the thread must first be suspended.Asynchronous Procedure Call (APC) injection involves attaching malicious code to the APC Queue [3] of a process's thread. Queued APC functions are executed when the thread enters an alterable state. A variation of APC injection, dubbed \"Early Bird injection\", involves creating a suspended process in which malicious code can be written and executed before the process' entry point (and potentially subsequent anti-malware hooks) via an APC. [4]  AtomBombing  [5] is another variation that utilizes APCs to invoke malicious code previously written to the global atom table. [6]Thread Local Storage (TLS) callback injection involves manipulating pointers inside a portable executable (PE) to redirect a process to malicious code before reaching the code's legitimate entry point. [7]Mac and LinuxImplementations for Linux and OS X/macOS systems include: [8] [9]LD_PRELOAD, LD_LIBRARY_PATH (Linux), DYLD_INSERT_LIBRARIES (Mac OS X) environment variables, or the dlfcn application programming interface (API) can be used to dynamically load a library (shared object) in a process which can be used to intercept API calls from the running process. [10]Ptrace system calls can be used to attach to a running process and modify it in runtime. [9]/proc/[pid]/mem provides access to the memory of the process and can be used to read/write arbitrary data to it. This technique is very rare due to its complexity. [9]VDSO hijacking performs runtime injection on ELF binaries by manipulating code stubs mapped in from the linux-vdso.so shared object. [11]Malware commonly utilizes process injection to access system resources through which Persistence and other environment modifications can be made. More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.\n", "ID": "T1055", "Tactic": "Defense Evasion,                                                Privilege Escalation", "Platform": "Linux, macOS, Windows", "Permissions Required": "User, Administrator, SYSTEM, root", "Effective Permissions": "User, Administrator, SYSTEM, root", "Data Sources": "API monitoring, Windows Registry, File monitoring, DLL monitoring, Process monitoring, Named Pipes", "Defense Bypassed": "Process whitelisting, Anti-virus", "CAPEC ID": "CAPEC-640", "Contributors": "Anastasios Pingios; Christiaan Beek, @ChristiaanBeek; Ryan Becwar", "Version": "1.0", "Created": "31 May 2017", "Last Modified": "18 July 2019", "references": [{"index": 1, "title": "Hosseini, A. (2017, July 18). Ten Process Injection Techniques: A Technical Survey Of Common And Trending Process Injection Techniques. Retrieved December 7, 2017.", "external_link": "https://www.endgame.com/blog/technical-blog/ten-process-injection-techniques-technical-survey-common-and-trending-process"}, {"index": 2, "title": "Desimone, J. (2017, June 13). Hunting in Memory. Retrieved December 7, 2017.", "external_link": "https://www.endgame.com/blog/technical-blog/hunting-memory"}, {"index": 3, "title": "Microsoft. (n.d.). Asynchronous Procedure Calls. Retrieved December 8, 2017.", "external_link": "https://msdn.microsoft.com/library/windows/desktop/ms681951.aspx"}, {"index": 4, "title": "Gavriel, H. & Erbesfeld, B. (2018, April 11). New \u2018Early Bird\u2019 Code Injection Technique Discovered. Retrieved May 24, 2018.", "external_link": "https://www.cyberbit.com/blog/endpoint-security/new-early-bird-code-injection-technique-discovered/"}, {"index": 5, "title": "Liberman, T. (2016, October 27). ATOMBOMBING: BRAND NEW CODE INJECTION FOR WINDOWS. Retrieved December 8, 2017.", "external_link": "https://blog.ensilo.com/atombombing-brand-new-code-injection-for-windows"}, {"index": 6, "title": "Microsoft. (n.d.). About Atom Tables. Retrieved December 8, 2017.", "external_link": "https://msdn.microsoft.com/library/windows/desktop/ms649053.aspx"}, {"index": 7, "title": "Vaish, A. & Nemes, S. (2017, November 28). Newly Observed Ursnif Variant Employs Malicious TLS Callback Technique to Achieve Process Injection. Retrieved December 18, 2017.", "external_link": "https://www.fireeye.com/blog/threat-research/2017/11/ursnif-variant-malicious-tls-callback-technique.html"}, {"index": 8, "title": "Turner-Trauring, I. (2017, April 18). \u201cThis will only hurt for a moment\u201d: code injection on Linux and macOS with LD_PRELOAD. Retrieved December 20, 2017.", "external_link": "https://www.datawire.io/code-injection-on-linux-and-macos/"}, {"index": 9, "title": "skape. (2003, January 19). Linux x86 run-time process manipulation. Retrieved December 20, 2017.", "external_link": "http://hick.org/code/skape/papers/needle.txt"}, {"index": 10, "title": "halflife. (1997, September 1). Shared Library Redirection Techniques. Retrieved December 20, 2017.", "external_link": "http://phrack.org/issues/51/8.html"}, {"index": 11, "title": "O'Neill, R. (2009, May). Modern Day ELF Runtime infection via GOT poisoning. Retrieved December 20, 2017.", "external_link": "http://vxer.org/lib/vrn00.html"}, {"index": 12, "title": "PowerShellMafia. (2012, May 26). PowerSploit - A PowerShell Post-Exploitation Framework. Retrieved February 6, 2018.", "external_link": "https://github.com/PowerShellMafia/PowerSploit"}, {"index": 13, "title": "PowerSploit. (n.d.). PowerSploit. Retrieved February 6, 2018.", "external_link": "http://powersploit.readthedocs.io"}, {"index": 14, "title": "Magius, J., et al. (2017, July 19). Koadic. Retrieved June 18, 2018.", "external_link": "https://github.com/zerosum0x0/koadic"}, {"index": 15, "title": "Nicolas Verdier. (n.d.). Retrieved January 29, 2018.", "external_link": "https://github.com/n1nj4sec/pupy"}, {"index": 16, "title": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "external_link": "https://cobaltstrike.com/downloads/csmanual38.pdf"}, {"index": 17, "title": "Bacurio, F., Salvio, J. (2017, February 14). REMCOS: A New RAT In The Wild. Retrieved November 6, 2018.", "external_link": "https://www.fortinet.com/blog/threat-research/remcos-a-new-rat-in-the-wild-2.html"}, {"index": 18, "title": "Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.", "external_link": "https://github.com/PowerShellEmpire/Empire"}, {"index": 19, "title": "Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.", "external_link": "https://github.com/nettitude/PoshC2_Python"}, {"index": 20, "title": "The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019.", "external_link": "https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf"}, {"index": 21, "title": "F-Secure Labs. (2014). BlackEnergy & Quedagh: The convergence of crimeware and APT attacks. Retrieved March 24, 2016.", "external_link": "https://www.f-secure.com/documents/996508/1030745/blackenergy_whitepaper.pdf"}, {"index": 22, "title": "Windows Defender Advanced Threat Hunting Team. (2016, April 29). PLATINUM: Targeted attacks in South and Southeast Asia. Retrieved February 15, 2018.", "external_link": "https://download.microsoft.com/download/2/2/5/225BFE3E-E1DE-4F5B-A77B-71200928D209/Platinum%20feature%20article%20-%20Targeted%20attacks%20in%20South%20and%20Southeast%20Asia%20April%202016.pdf"}, {"index": 23, "title": "FireEye. (2014). POISON IVY: Assessing Damage and Extracting Intelligence. Retrieved November 12, 2014.", "external_link": "https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-poison-ivy.pdf"}, {"index": 24, "title": "Hayashi, K. (2005, August 18). Backdoor.Darkmoon. Retrieved February 23, 2018.", "external_link": "https://www.symantec.com/security_response/writeup.jsp?docid=2005-081910-3934-99"}, {"index": 25, "title": "Symantec Security Response. (2015, June 23). Dyre: Emerging threat on financial fraud landscape. Retrieved August 23, 2018.", "external_link": "http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/dyre-emerging-threat.pdf"}, {"index": 26, "title": "Camba, A. (2013, February 27). BKDR_RARSTONE: New RAT to Watch Out For. Retrieved January 8, 2016.", "external_link": "http://blog.trendmicro.com/trendlabs-security-intelligence/bkdr_rarstone-new-rat-to-watch-out-for/"}, {"index": 27, "title": "Blasco, J. (2011, December 12). Another Sykipot sample likely targeting US federal agencies. Retrieved March 28, 2016.", "external_link": "https://www.alienvault.com/open-threat-exchange/blog/another-sykipot-sample-likely-targeting-us-federal-agencies"}, {"index": 28, "title": "F-Secure. (2015, September 8). Sofacy Recycles Carberp and Metasploit Code. Retrieved August 3, 2016.", "external_link": "https://labsblog.f-secure.com/2015/09/08/sofacy-recycles-carberp-and-metasploit-code/"}, {"index": 29, "title": "Lee, B, et al. (2018, February 28). Sofacy Attacks Multiple Government Entities. Retrieved March 15, 2018.", "external_link": "https://researchcenter.paloaltonetworks.com/2018/02/unit42-sofacy-attacks-multiple-government-entities/"}, {"index": 30, "title": "Levene, B, et al. (2017, May 03). Kazuar: Multiplatform Espionage Backdoor with API Access. Retrieved July 17, 2018.", "external_link": "https://researchcenter.paloaltonetworks.com/2017/05/unit42-kazuar-multiplatform-espionage-backdoor-api-access/"}, {"index": 31, "title": "Grunzweig, J.. (2017, April 20). Cardinal RAT Active for Over Two Years. Retrieved December 8, 2018.", "external_link": "https://researchcenter.paloaltonetworks.com/2017/04/unit42-cardinal-rat-active-two-years/"}, {"index": 32, "title": "ESET. (2017, August). Gazing at Gazer: Turla\u2019s new second stage backdoor. Retrieved September 14, 2017.", "external_link": "https://www.welivesecurity.com/wp-content/uploads/2017/08/eset-gazer.pdf"}, {"index": 33, "title": "Kaspersky Lab's Global Research & Analysis Team. (2017, August 30). Introducing WhiteBear. Retrieved September 21, 2017.", "external_link": "https://securelist.com/introducing-whitebear/81638/"}, {"index": 34, "title": "Perigaud, F. (2015, December 15). Newcomers in the Derusbi family. Retrieved December 20, 2017.", "external_link": "http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family"}, {"index": 35, "title": "Symantec Security Response. (2014, July 7). Dragonfly: Cyberespionage Attacks Against Energy Suppliers. Retrieved April 8, 2016.", "external_link": "http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/Dragonfly_Threat_Against_Western_Energy_Suppliers.pdf"}, {"index": 36, "title": "FinFisher. (n.d.). Retrieved December 20, 2017.", "external_link": "http://www.finfisher.com/FinFisher/index.html"}, {"index": 37, "title": "Allievi, A.,Flori, E. (2018, March 01). FinFisher exposed: A researcher\u2019s tale of defeating traps, tricks, and complex virtual machines. Retrieved July 9, 2018.", "external_link": "https://cloudblogs.microsoft.com/microsoftsecure/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/"}, {"index": 38, "title": "Falcone, R., et al.. (2015, June 16). Operation Lotus Blossom. Retrieved February 15, 2016.", "external_link": "https://www.paloaltonetworks.com/resources/research/unit42-operation-lotus-blossom.html"}, {"index": 39, "title": "Accenture Security. (2018, January 27). DRAGONFISH DELIVERS NEW FORM OF ELISE MALWARE TARGETING ASEAN DEFENCE MINISTERS\u2019 MEETING AND ASSOCIATES. Retrieved November 14, 2018.", "external_link": "https://www.accenture.com/t20180127T003755Z_w_/us-en/_acnmedia/PDF-46/Accenture-Security-Dragonfish-Threat-Analysis.pdf"}, {"index": 40, "title": "Lei, C., et al. (2018, January 24). Lazarus Campaign Targeting Cryptocurrencies Reveals Remote Controller Tool, an Evolved RATANKBA, and More. Retrieved May 22, 2018.", "external_link": "https://blog.trendmicro.com/trendlabs-security-intelligence/lazarus-campaign-targeting-cryptocurrencies-reveals-remote-controller-tool-evolved-ratankba/"}, {"index": 41, "title": "Trend Micro. (2017, February 27). RATANKBA: Delving into Large-scale Watering Holes against Enterprises. Retrieved May 22, 2018.", "external_link": "https://blog.trendmicro.com/trendlabs-security-intelligence/ratankba-watering-holes-against-enterprises/"}, {"index": 42, "title": "Kaspersky Lab's Global Research & Analysis Team. (2016, August 9). The ProjectSauron APT. Technical Analysis. Retrieved August 17, 2016.", "external_link": "https://securelist.com/files/2016/07/The-ProjectSauron-APT_Technical_Analysis_KL.pdf"}, {"index": 43, "title": "Cherepanov, A. (2018, October). GREYENERGY A successor to BlackEnergy. Retrieved November 15, 2018.", "external_link": "https://www.welivesecurity.com/wp-content/uploads/2018/10/ESET_GreyEnergy.pdf"}, {"index": 44, "title": "Anthe, C. et al. (2016, December 14). Microsoft Security Intelligence Report Volume 21. Retrieved November 27, 2017.", "external_link": "http://download.microsoft.com/download/E/B/0/EB0F50CC-989C-4B66-B7F6-68CD3DC90DE3/Microsoft_Security_Intelligence_Report_Volume_21_English.pdf"}, {"index": 45, "title": "Lunghi, D., et al. (2017, December). Untangling the Patchwork Cyberespionage Group. Retrieved July 10, 2018.", "external_link": "https://documents.trendmicro.com/assets/tech-brief-untangling-the-patchwork-cyberespionage-group.pdf"}, {"index": 46, "title": "ESET. (2016, October). En Route with Sednit - Part 3: A Mysterious Downloader. Retrieved November 21, 2016.", "external_link": "http://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-part3.pdf"}, {"index": 47, "title": "Ebach, L. (2017, June 22). Analysis Results of Zeus.Variant.Panda. Retrieved November 5, 2018.", "external_link": "https://cyberwtf.files.wordpress.com/2017/07/panda-whitepaper.pdf"}, {"index": 48, "title": "Falcone, R. and Miller-Osborn, J.. (2015, December 18). Attack on French Diplomat Linked to Operation Lotus Blossom. Retrieved February 15, 2016.", "external_link": "http://researchcenter.paloaltonetworks.com/2015/12/attack-on-french-diplomat-linked-to-operation-lotus-blossom/"}, {"index": 49, "title": "Symantec Security Response. (2011, November). W32.Duqu: The precursor to the next Stuxnet. Retrieved September 17, 2015.", "external_link": "https://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/w32_duqu_the_precursor_to_the_next_stuxnet.pdf"}, {"index": 50, "title": "Zhou, R. (2012, May 15). Backdoor.Wiarp. Retrieved February 22, 2018.", "external_link": "https://www.symantec.com/security_response/writeup.jsp?docid=2012-051606-1005-99"}, {"index": 51, "title": "Trend Micro. (2012). The Taidoor Campaign. Retrieved November 12, 2014.", "external_link": "http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp_the_taidoor_campaign.pdf"}, {"index": 52, "title": "ESET. (2017, March 30). Carbon Paper: Peering into Turla\u2019s second stage backdoor. Retrieved November 7, 2018.", "external_link": "https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/"}, {"index": 53, "title": "Baker, B., Unterbrink H. (2018, July 03). Smoking Guns - Smoke Loader learned new tricks. Retrieved July 5, 2018.", "external_link": "https://blog.talosintelligence.com/2018/07/smoking-guns-smoke-loader-learned-new.html#more"}, {"index": 54, "title": "Bennett, J., Vengerik, B. (2017, June 12). Behind the CARBANAK Backdoor. Retrieved June 11, 2018.", "external_link": "https://www.fireeye.com/blog/threat-research/2017/06/behind-the-carbanak-backdoor.html"}, {"index": 55, "title": "Mercer, W., Rascagneres, P. (2018, May 31). NavRAT Uses US-North Korea Summit As Decoy For Attacks In South Korea. Retrieved June 11, 2018.", "external_link": "https://blog.talosintelligence.com/2018/05/navrat.html"}, {"index": 56, "title": "Salinas, M., Holguin, J. (2017, June). Evolution of Trickbot. Retrieved July 31, 2018.", "external_link": "https://www.securityartwork.es/wp-content/uploads/2017/07/Trickbot-report-S2-Grupo.pdf"}, {"index": 57, "title": "Antazo, F. (2016, October 31). TSPY_TRICKLOAD.N. Retrieved September 14, 2018.", "external_link": "https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/tspy_trickload.n"}, {"index": 58, "title": "Pornasdoro, A. (2017, October 12). Trojan:Win32/Totbrick. Retrieved September 14, 2018.", "external_link": "https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Win32/Totbrick"}, {"index": 59, "title": "Minerva Labs LTD and ClearSky Cyber Security. (2015, November 23). CopyKittens Attack Group. Retrieved September 11, 2017.", "external_link": "https://s3-eu-west-1.amazonaws.com/minervaresearchpublic/CopyKittens/CopyKittens.pdf"}, {"index": 60, "title": "Trend Micro. (2018, November 20). Lazarus Continues Heists, Mounts Attacks on Financial Organizations in Latin America. Retrieved December 3, 2018.", "external_link": "https://blog.trendmicro.com/trendlabs-security-intelligence/lazarus-continues-heists-mounts-attacks-on-financial-organizations-in-latin-america/"}, {"index": 61, "title": "Dahan, A. (2017). Operation Cobalt Kitty. Retrieved December 27, 2018.", "external_link": "https://cdn2.hubspot.net/hubfs/3354902/Cybereason%20Labs%20Analysis%20Operation%20Cobalt%20Kitty.pdf"}, {"index": 62, "title": "\u00d6zarslan, S. (2018, December 21). The Christmas Card you never wanted - A new wave of Emotet is back to wreak havoc. Retrieved March 25, 2019.", "external_link": "https://www.picussecurity.com/blog/the-christmas-card-you-never-wanted-a-new-wave-of-emotet-is-back-to-wreak-havoc.html"}, {"index": 63, "title": "Salvio, J.. (2014, June 27). New Banking Malware Uses Network Sniffing for Data Theft. Retrieved March 25, 2019.", "external_link": "https://blog.trendmicro.com/trendlabs-security-intelligence/new-banking-malware-uses-network-sniffing-for-data-theft/"}, {"index": 64, "title": "US-CERT. (2018, July 20). Alert (TA18-201A) Emotet Malware. Retrieved March 25, 2019.", "external_link": "https://www.us-cert.gov/ncas/alerts/TA18-201A"}, {"index": 65, "title": "US-CERT. (2019, April 10). MAR-10135536-8 \u2013 North Korean Trojan: HOPLIGHT. Retrieved April 19, 2019.", "external_link": "https://www.us-cert.gov/ncas/analysis-reports/AR19-100A"}, {"index": 66, "title": "Kaspersky Lab. (2017, March 7). From Shamoon to StoneDrill: Wipers attacking Saudi organizations and beyond. Retrieved March 14, 2019.", "external_link": "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07180722/Report_Shamoon_StoneDrill_final.pdf"}, {"index": 67, "title": "Caragay, R. (2015, March 26). URSNIF: The Multifaceted Malware. Retrieved June 5, 2019.", "external_link": "https://blog.trendmicro.com/trendlabs-security-intelligence/ursnif-the-multifaceted-malware/?_ga=2.165628854.808042651.1508120821-744063452.1505819992"}, {"index": 68, "title": "Trend Micro. (2014, December 11). PE_URSNIF.A2. Retrieved June 5, 2019.", "external_link": "https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/PE_URSNIF.A2?_ga=2.131425807.1462021705.1559742358-1202584019.1549394279"}, {"index": 69, "title": "Vaish, A. & Nemes, S. (2017, November 28). Newly Observed Ursnif Variant Employs Malicious TLS Callback Technique to Achieve Process Injection. Retrieved June 5, 2019.", "external_link": "https://www.fireeye.com/blog/threat-research/2017/11/ursnif-variant-malicious-tls-callback-technique.html"}, {"index": 70, "title": "Sanmillan, I. (2019, May 29). HiddenWasp Malware Stings Targeted Linux Systems. Retrieved June 24, 2019.", "external_link": "https://www.intezer.com/blog-hiddenwasp-malware-targeting-linux-systems/"}, {"index": 71, "title": "Falcone, R. and Lancaster, T.. (2019, May 28). Emissary Panda Attacks Middle East Government Sharepoint Servers. Retrieved July 9, 2019.", "external_link": "https://unit42.paloaltonetworks.com/emissary-panda-attacks-middle-east-government-sharepoint-servers/"}, {"index": 72, "title": "Allievi, A., et al. (2014, October 28). Threat Spotlight: Group 72, Opening the ZxShell. Retrieved September 24, 2019.", "external_link": "https://blogs.cisco.com/security/talos/opening-zxshell"}, {"index": 73, "title": "Falcone, R., et al. (2018, August 02). The Gorgon Group: Slithering Between Nation State and Cybercrime. Retrieved August 7, 2018.", "external_link": "https://researchcenter.paloaltonetworks.com/2018/08/unit42-gorgon-group-slithering-nation-state-cybercrime/"}, {"index": 74, "title": "Sherstobitoff, R. (2018, February 12). Lazarus Resurfaces, Targets Global Banks and Bitcoin Users. Retrieved February 19, 2018.", "external_link": "https://securingtomorrow.mcafee.com/mcafee-labs/lazarus-resurfaces-targets-global-banks-bitcoin-users/"}, {"index": 75, "title": "ESET Research. (2018, May 22). Turla Mosquito: A shift towards more generic tools. Retrieved July 3, 2018.", "external_link": "https://www.welivesecurity.com/2018/05/22/turla-mosquito-shift-towards-generic-tools/"}, {"index": 76, "title": "Rapid7. (2013, November 26). meterpreter/source/extensions/priv/server/elevate/. Retrieved July 8, 2018.", "external_link": "https://github.com/rapid7/meterpreter/tree/master/source/extensions/priv/server/elevate"}, {"index": 77, "title": "Faou, M. and Dumont R.. (2019, May 29). A dive into Turla PowerShell usage. Retrieved June 14, 2019.", "external_link": "https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/"}, {"index": 78, "title": "Pantazopoulos, N., Henry T. (2018, May 18). Emissary Panda \u2013 A potential new malicious tool. Retrieved June 25, 2018.", "external_link": "https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/may/emissary-panda-a-potential-new-malicious-tool/"}, {"index": 79, "title": "Legezo, D. (2018, June 13). LuckyMouse hits national data center to organize country-level waterholing campaign. Retrieved August 18, 2018.", "external_link": "https://securelist.com/luckymouse-hits-national-data-center/86083/"}, {"index": 80, "title": "Matveeva, V. (2017, August 15). Secrets of Cobalt. Retrieved October 10, 2018.", "external_link": "https://www.group-ib.com/blog/cobalt"}, {"index": 81, "title": "Mercer, W., Rascagneres, P. (2018, January 16). Korea In The Crosshairs. Retrieved May 21, 2018.", "external_link": "https://blog.talosintelligence.com/2018/01/korea-in-crosshairs.html"}, {"index": 82, "title": "Horejsi, J., et al. (2018, March 14). Tropic Trooper\u2019s New Strategy. Retrieved November 9, 2018.", "external_link": "https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/"}, {"index": 83, "title": "Sherstobitoff, R. (2018, March 02). McAfee Uncovers Operation Honeybee, a Malicious Document Campaign Targeting Humanitarian Aid Groups. Retrieved May 16, 2018.", "external_link": "https://securingtomorrow.mcafee.com/mcafee-labs/mcafee-uncovers-operation-honeybee-malicious-document-campaign-targeting-humanitarian-aid-groups/"}, {"index": 84, "title": "Crowdstrike Global Intelligence Team. (2014, June 9). CrowdStrike Intelligence Report: Putter Panda. Retrieved January 22, 2016.", "external_link": "http://cdn0.vox-cdn.com/assets/4589853/crowdstrike-intelligence-report-putter-panda.original.pdf"}, {"index": 85, "title": "Tarakanov , D.. (2013, September 11). The \u201cKimsuky\u201d Operation: A North Korean APT?. Retrieved August 13, 2019.", "external_link": "https://securelist.com/the-kimsuky-operation-a-north-korean-apt/57915/"}, {"index": 86, "title": "Fraser, N., et al. (2019, August 7). Double DragonAPT41, a dual espionage and cyber crime operation APT41. Retrieved September 23, 2019.", "external_link": "https://content.fireeye.com/apt-41/rpt-apt41"}, {"index": 87, "title": "Ligh, M.H. et al.. (2014, July). The Art of Memory Forensics: Detecting Malware and Threats in Windows, Linux, and Mac Memory. Retrieved December 20, 2017.", "external_link": ""}, {"index": 88, "title": "GNU. (2010, February 5). The GNU Accounting Utilities. Retrieved December 20, 2017.", "external_link": "https://www.gnu.org/software/acct/"}, {"index": 89, "title": "Jahoda, M. et al.. (2017, March 14). redhat Security Guide - Chapter 7 - System Auditing. Retrieved December 20, 2017.", "external_link": "https://access.redhat.com/documentation/red_hat_enterprise_linux/6/html/security_guide/chap-system_auditing"}, {"index": 90, "title": "stderr. (2014, February 14). Detecting Userland Preload Rootkits. Retrieved December 20, 2017.", "external_link": "http://www.chokepoint.net/2014/02/detecting-userland-preload-rootkits.html"}, {"index": 91, "title": "Russinovich, M. & Garnier, T. (2017, May 22). Sysmon v6.20. Retrieved December 13, 2017.", "external_link": "https://docs.microsoft.com/sysinternals/downloads/sysmon"}, {"index": 92, "title": "PowerSploit. (n.d.). Retrieved December 4, 2014.", "external_link": "https://github.com/mattifestation/PowerSploit"}], "related": [{"link": "https://attack.mitre.org/groups/G0067", "Name": "APT37", "Description": "APT37 injects its malware variant, ROKRAT, into the cmd.exe process.[81]"}, {"link": "https://attack.mitre.org/groups/G0096", "Name": "APT41", "Description": "APT41 malware TIDYELF loaded the main WINTERLOVE component by injecting it into the iexplore.exe process.[86]"}, {"link": "https://attack.mitre.org/software/S0347", "Name": "AuditCred", "Description": "AuditCred can inject code from files to other running processes.[60]"}, {"link": "https://attack.mitre.org/software/S0093", "Name": "Backdoor.Oldrea", "Description": "Backdoor.Oldrea injects itself into explorer.exe.[35]"}, {"link": "https://attack.mitre.org/software/S0089", "Name": "BlackEnergy", "Description": "BlackEnergy injects its DLL component into svchost.exe.[21]"}, {"link": "https://attack.mitre.org/software/S0030", "Name": "Carbanak", "Description": "Carbanak downloads an executable and injects it directly into a new process.[54]"}, {"link": "https://attack.mitre.org/software/S0335", "Name": "Carbon", "Description": "Carbon has a command to inject code into a process.[52]"}, {"link": "https://attack.mitre.org/software/S0348", "Name": "Cardinal RAT", "Description": "Cardinal RAT injects into a newly spawned process created from a native Windows executable.[31]"}, {"link": "https://attack.mitre.org/groups/G0080", "Name": "Cobalt Group", "Description": "Cobalt Group has injected code into trusted processes.[80]"}, {"link": "https://attack.mitre.org/software/S0154", "Name": "Cobalt Strike", "Description": "Cobalt Strike can inject a variety of payloads into processes dynamically chosen by the adversary.[16]"}, {"link": "https://attack.mitre.org/software/S0354", "Name": "Denis", "Description": "Denis injects its payload into Windows host processes.[61]"}, {"link": "https://attack.mitre.org/software/S0021", "Name": "Derusbi", "Description": "Derusbi injects itself into the secure shell (SSH) process.[34]"}, {"link": "https://attack.mitre.org/software/S0038", "Name": "Duqu", "Description": "Duqu will inject itself into different processes to evade detection. The selection of the target process is influenced by the security software that is installed on the system (Duqu will inject into different processes depending on which security suite is installed on the infected host).[49]"}, {"link": "https://attack.mitre.org/software/S0024", "Name": "Dyre", "Description": "Dyre injects into other processes to load modules.[25]"}, {"link": "https://attack.mitre.org/software/S0081", "Name": "Elise", "Description": "Elise injects DLL files into iexplore.exe.[38][39]"}, {"link": "https://attack.mitre.org/software/S0082", "Name": "Emissary", "Description": "Emissary injects its DLL file into a newly spawned Internet Explorer process.[48]"}, {"link": "https://attack.mitre.org/software/S0367", "Name": "Emotet", "Description": "Emotet has been observed injecting in to Explorer.exe and other processes.[62][63][64]"}, {"link": "https://attack.mitre.org/software/S0363", "Name": "Empire", "Description": "Empire contains multiple modules for injecting into processes, such as Invoke-PSInject.[18]"}, {"link": "https://attack.mitre.org/software/S0182", "Name": "FinFisher", "Description": "FinFisher injects itself into various processes depending on whether it is low integrity or high integrity.[36][37]"}, {"link": "https://attack.mitre.org/software/S0168", "Name": "Gazer", "Description": "Gazer performs thread execution hijacking to inject its orchestrator into a running thread from a remote process. Gazer performs a separate injection of its communication module into an Internet accessible process through which it performs C2.[32][33]"}, {"link": "https://attack.mitre.org/groups/G0078", "Name": "Gorgon Group", "Description": "Gorgon Group malware can download a remote access tool, ShiftyBug, and inject into another process.[73]"}, {"link": "https://attack.mitre.org/software/S0342", "Name": "GreyEnergy", "Description": "GreyEnergy has a module to inject a PE binary into a remote process.[43]"}, {"link": "https://attack.mitre.org/software/S0394", "Name": "HiddenWasp", "Description": "HiddenWasp adds itself to the LD_PRELOAD path and sets a series of environment variables.[70]"}, {"link": "https://attack.mitre.org/software/S0135", "Name": "HIDEDRV", "Description": "HIDEDRV injects a DLL for Downdelph into the explorer.exe process.[46]"}, {"link": "https://attack.mitre.org/groups/G0072", "Name": "Honeybee", "Description": "Honeybee uses a batch file to load a DLL into the svchost.exe process.[83]"}, {"link": "https://attack.mitre.org/software/S0376", "Name": "HOPLIGHT", "Description": "HOPLIGHT has injected into running processes.    [65]"}, {"link": "https://attack.mitre.org/software/S0040", "Name": "HTRAN", "Description": "HTRAN can inject into into running processes.[20]"}, {"link": "https://attack.mitre.org/software/S0398", "Name": "HyperBro", "Description": "HyperBro can run shellcode it injects into a newly created process.[71]"}, {"link": "https://attack.mitre.org/software/S0044", "Name": "JHUHUGIT", "Description": "JHUHUGIT performs code injection injecting its own functions to browser processes.[28][29]"}, {"link": "https://attack.mitre.org/software/S0201", "Name": "JPIN", "Description": "JPIN can inject content into lsass.exe to load a module.[22]"}, {"link": "https://attack.mitre.org/software/S0265", "Name": "Kazuar", "Description": "If running in a Windows environment, Kazuar saves a DLL to disk that is injected into the explorer.exe process to execute the payload. Kazuar can also be configured to inject and execute within specific processes.[30]"}, {"link": "https://attack.mitre.org/groups/G0094", "Name": "Kimsuky", "Description": "Kimsuky has used Win7Elevate to inject malicious code into explorer.exe.[85]"}, {"link": "https://attack.mitre.org/software/S0250", "Name": "Koadic", "Description": "Koadic can perform process injection by using a reflective DLL.[14]"}, {"link": "https://attack.mitre.org/groups/G0032", "Name": "Lazarus Group", "Description": "A Lazarus Group malware sample performs reflective DLL injection.[74]"}, {"link": "https://attack.mitre.org/software/S0167", "Name": "Matroyshka", "Description": "Matroyshka uses reflective DLL injection to inject the malicious library and execute the RAT.[59]"}, {"link": "https://attack.mitre.org/software/S0247", "Name": "NavRAT", "Description": "NavRAT copies itself into a running Internet Explorer process to evade detection.[55]"}, {"link": "https://attack.mitre.org/groups/G0068", "Name": "PLATINUM", "Description": "PLATINUM has used various methods of process injection including hot patching.[22]"}, {"link": "https://attack.mitre.org/software/S0012", "Name": "PoisonIvy", "Description": "PoisonIvy can inject a malicious DLL into a process.[23][24]"}, {"link": "https://attack.mitre.org/software/S0378", "Name": "PoshC2", "Description": "PoshC2 contains multiple modules for injecting into processes, such as Invoke-PSInject.[19]"}, {"link": "https://attack.mitre.org/software/S0194", "Name": "PowerSploit", "Description": "PowerSploit contains a collection of CodeExecution modules that enable by injecting code (DLL, shellcode) or reflectively loading a Windows PE file into a process.[12][13]"}, {"link": "https://attack.mitre.org/software/S0192", "Name": "Pupy", "Description": "Pupy can migrate into another process using reflective DLL injection.[15]"}, {"link": "https://attack.mitre.org/groups/G0024", "Name": "Putter Panda", "Description": "An executable dropped onto victims by Putter Panda aims to inject the specified DLL into a process that would normally be accessing the network, including Outlook Express (msinm.exe), Outlook (outlook.exe), Internet Explorer (iexplore.exe), and Firefox (firefox.exe).[84]"}, {"link": "https://attack.mitre.org/software/S0055", "Name": "RARSTONE", "Description": "After decrypting itself in memory, RARSTONE downloads a DLL file from its C2 server and loads it in the memory space of a hidden Internet Explorer process. This \"downloaded\" file is actually not dropped onto the system.[26]"}, {"link": "https://attack.mitre.org/software/S0241", "Name": "RATANKBA", "Description": "RATANKBA performs a reflective DLL injection using a given pid.[40][41]"}, {"link": "https://attack.mitre.org/software/S0332", "Name": "Remcos", "Description": "Remcos has a command to hide itself through injecting into another process.[17]"}, {"link": "https://attack.mitre.org/software/S0125", "Name": "Remsec", "Description": "Remsec can perform DLL injection.[42]"}, {"link": "https://attack.mitre.org/software/S0226", "Name": "Smoke Loader", "Description": "Smoke Loader injects into the Internet Explorer process.[53]"}, {"link": "https://attack.mitre.org/software/S0273", "Name": "Socksbot", "Description": "Socksbot creates a suspended svchost process and injects its DLL into it.[45]"}, {"link": "https://attack.mitre.org/software/S0380", "Name": "StoneDrill", "Description": "StoneDrill has relied on injecting its payload directly into the process memory of the victim's preferred browser.[66]"}, {"link": "https://attack.mitre.org/software/S0018", "Name": "Sykipot", "Description": "Sykipot injects itself into running instances of outlook.exe, iexplore.exe, or firefox.exe.[27]"}, {"link": "https://attack.mitre.org/software/S0011", "Name": "Taidoor", "Description": "Taidoor can perform DLL loading.[51]"}, {"link": "https://attack.mitre.org/groups/G0027", "Name": "Threat Group-3390", "Description": "A Threat Group-3390 tool can spawn svchost.exe and inject the payload into that process.[78][79]"}, {"link": "https://attack.mitre.org/software/S0266", "Name": "TrickBot", "Description": "TrickBot injects into the svchost.exe process.[56][57][58]"}, {"link": "https://attack.mitre.org/groups/G0081", "Name": "Tropic Trooper", "Description": "Tropic Trooper has injected a DLL backdoor into a file dllhost.exe.[82]"}, {"link": "https://attack.mitre.org/groups/G0010", "Name": "Turla", "Description": "Turla has used Metasploit to perform reflective DLL injection in order to escalate privileges. Turla has also used PowerSploit's Invoke-ReflectivePEInjection.ps1 to reflectively load a PowerShell payload into a random process on the victim system.[75][76][77]"}, {"link": "https://attack.mitre.org/software/S0199", "Name": "TURNEDUP", "Description": "TURNEDUP is capable of injecting code into the APC queue of a created Rundll32 process as part of an \"Early Bird injection.\"[4]"}, {"link": "https://attack.mitre.org/software/S0386", "Name": "Ursnif", "Description": "Ursnif has injected code into target processes via thread local storage callbacks.[67][68][69]"}, {"link": "https://attack.mitre.org/software/S0206", "Name": "Wiarp", "Description": "Wiarp creates a backdoor through which remote attackers can inject files into running processes.[50]"}, {"link": "https://attack.mitre.org/software/S0176", "Name": "Wingbird", "Description": "Wingbird performs multiple process injections to hijack system processes and execute malicious code.[44]"}, {"link": "https://attack.mitre.org/software/S0330", "Name": "Zeus Panda", "Description": "Zeus Panda checks processes on the system and if they meet the necessary requirements, it injects into that process.[47]"}, {"link": "https://attack.mitre.org/software/S0412", "Name": "ZxShell", "Description": "ZxShell is injected into a shared SVCHOST process. [72]"}, {"Mitigation": "Behavior Prevention on Endpoint", "Description": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process."}, {"Mitigation": "Privileged Account Management", "Description": "LinuxUtilize Yama to mitigate ptrace based process injection by restricting the use of ptrace to privileged users only. Other mitigation controls involve the deployment of security kernel modules that provide advanced access control and process restrictions such as SELinux, grsecurity, and AppArmor."}]}