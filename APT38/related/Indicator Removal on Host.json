{"title": "Indicator Removal on Host", "descrption": "\nAdversaries may delete or alter generated artifacts on a host system, including logs and potentially captured files such as quarantined malware. Locations and format of logs will vary, but typical organic system logs are captured as Windows events or Linux/macOS files such as Bash History and /var/log/* .Actions that interfere with eventing and other notifications that can be used to detect intrusion activity may compromise the integrity of security solutions, causing events to go unreported. They may also make forensic analysis and incident response more difficult due to lack of sufficient data to determine what occurred.Clear Windows Event LogsWindows event logs are a record of a computer's alerts and notifications. Microsoft defines an event as \"any significant occurrence in the system or in a program that requires users to be notified or an entry added to a log.\" There are three system-defined sources of Events: System, Application, and Security.Adversaries performing actions related to account management, account logon and directory service access, etc. may choose to clear the events in order to hide their activities.The event logs can be cleared with the following utility commands:wevtutil cl systemwevtutil cl applicationwevtutil cl securityLogs may also be cleared through other mechanisms, such as PowerShell.\n", "ID": "T1070", "Tactic": "Defense Evasion", "Platform": "Linux, macOS, Windows", "System Requirements": "Clearing the Windows event logs requires Administrator permissions", "Data Sources": "File monitoring, Process monitoring, Process command-line parameters, API monitoring, Windows event logs", "Defense Bypassed": "Log analysis, Host intrusion prevention systems, Anti-virus", "CAPEC ID": "CAPEC-93", "Contributors": "Ed Williams, Trustwave, SpiderLabs", "Version": "1.0", "Created": "31 May 2017", "Last Modified": "18 July 2019", "references": [{"index": 1, "title": "Nicolas Verdier. (n.d.). Retrieved January 29, 2018.", "external_link": "https://github.com/n1nj4sec/pupy"}, {"index": 2, "title": "Axel F, Pierre T. (2017, October 16). Leviathan: Espionage actor spearphishes maritime and defense targets. Retrieved February 15, 2018.", "external_link": "https://www.proofpoint.com/us/threat-insight/post/leviathan-espionage-actor-spearphishes-maritime-and-defense-targets"}, {"index": 3, "title": "Faou, M. and Boutin, J.. (2017, February). Read The Manual: A Guide to the RTM Banking Trojan. Retrieved March 9, 2017.", "external_link": "https://www.welivesecurity.com/wp-content/uploads/2017/02/Read-The-Manual.pdf"}, {"index": 4, "title": "FinFisher. (n.d.). Retrieved December 20, 2017.", "external_link": "http://www.finfisher.com/FinFisher/index.html"}, {"index": 5, "title": "Allievi, A.,Flori, E. (2018, March 01). FinFisher exposed: A researcher\u2019s tale of defeating traps, tricks, and complex virtual machines. Retrieved July 9, 2018.", "external_link": "https://cloudblogs.microsoft.com/microsoftsecure/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/"}, {"index": 6, "title": "US-CERT. (2017, December 13). Malware Analysis Report (MAR) - 10135536-B. Retrieved July 17, 2018.", "external_link": "https://www.us-cert.gov/sites/default/files/publications/MAR-10135536-B_WHITE.PDF"}, {"index": 7, "title": "Cherepanov, A.. (2016, January 3). BlackEnergy by the SSHBearDoor: attacks against Ukrainian news media and electric industry. Retrieved May 18, 2016.", "external_link": "http://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/"}, {"index": 8, "title": "Gross, J. (2016, February 23). Operation Dust Storm. Retrieved September 19, 2017.", "external_link": "https://www.cylance.com/content/dam/cylance/pdfs/reports/Op_Dust_Storm_Report.pdf"}, {"index": 9, "title": "Cherepanov, A.. (2016, May 17). Operation Groundbait: Analysis of a surveillance toolkit. Retrieved May 18, 2016.", "external_link": "http://www.welivesecurity.com/wp-content/uploads/2016/05/Operation-Groundbait.pdf"}, {"index": 10, "title": "Patrick Wardle. (n.d.). Mac Malware of 2017. Retrieved September 21, 2018.", "external_link": "https://objective-see.com/blog/blog_0x25.html"}, {"index": 11, "title": "FireEye Threat Intelligence. (2015, July 13). Demonstrating Hustle, Chinese APT Groups Quickly Use Zero-Day Vulnerability (CVE-2015-5119) Following Hacking Team Leak. Retrieved January 25, 2016.", "external_link": "https://www.fireeye.com/blog/threat-research/2015/07/demonstrating_hustle.html"}, {"index": 12, "title": "Ivanov, A. et al.. (2018, May 7). SynAck targeted ransomware uses the Doppelg\u00e4nging technique. Retrieved May 22, 2018.", "external_link": "https://securelist.com/synack-targeted-ransomware-uses-the-doppelganging-technique/85431/"}, {"index": 13, "title": "Symantec Security Response. (2010, January 18). The Trojan.Hydraq Incident. Retrieved February 20, 2018.", "external_link": "https://www.symantec.com/connect/blogs/trojanhydraq-incident"}, {"index": 14, "title": "Lelli, A. (2010, January 11). Trojan.Hydraq. Retrieved February 20, 2018.", "external_link": "https://www.symantec.com/security_response/writeup.jsp?docid=2010-011114-1830-99"}, {"index": 15, "title": "Sherstobitoff, R., Saavedra-Morales, J. (2018, February 02). Gold Dragon Widens Olympics Malware Attacks, Gains Permanent Presence on Victims\u2019 Systems. Retrieved June 6, 2018.", "external_link": "https://securingtomorrow.mcafee.com/mcafee-labs/gold-dragon-widens-olympics-malware-attacks-gains-permanent-presence-on-victims-systems/"}, {"index": 16, "title": "Ebach, L. (2017, June 22). Analysis Results of Zeus.Variant.Panda. Retrieved November 5, 2018.", "external_link": "https://cyberwtf.files.wordpress.com/2017/07/panda-whitepaper.pdf"}, {"index": 17, "title": "Mercer, W. and Rascagneres, P. (2018, February 12). Olympic Destroyer Takes Aim At Winter Olympics. Retrieved March 14, 2019.", "external_link": "https://blog.talosintelligence.com/2018/02/olympic-destroyer.html"}, {"index": 18, "title": "Chiu, A. (2016, June 27). New Ransomware Variant \"Nyetya\" Compromises Systems Worldwide. Retrieved March 26, 2019.", "external_link": "https://blog.talosintelligence.com/2017/06/worldwide-ransomware-variant.html"}, {"index": 19, "title": "Allievi, A., et al. (2014, October 28). Threat Spotlight: Group 72, Opening the ZxShell. Retrieved September 24, 2019.", "external_link": "https://blogs.cisco.com/security/talos/opening-zxshell"}, {"index": 20, "title": "Alperovitch, D.. (2016, June 15). Bears in the Midst: Intrusion into the Democratic National Committee. Retrieved August 3, 2016.", "external_link": "https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/"}, {"index": 21, "title": "Mueller, R. (2018, July 13). Indictment - United States of America vs. VIKTOR BORISOVICH NETYKSHO, et al. Retrieved September 13, 2018.", "external_link": "https://www.justice.gov/file/1080281/download"}, {"index": 22, "title": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.", "external_link": "https://www.us-cert.gov/ncas/alerts/TA18-074A"}, {"index": 23, "title": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.", "external_link": "https://www.us-cert.gov/ncas/alerts/TA17-293A"}, {"index": 24, "title": "Carr, N.. (2017, May 14). Cyber Espionage is Alive and Well: APT32 and the Threat to Global Corporations. Retrieved June 18, 2017.", "external_link": "https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html"}, {"index": 25, "title": "Bromiley, M. and Lewis, P. (2016, October 7). Attacking the Hospitality and Gaming Industries: Tracking an Attacker Around the World in 7 Years. Retrieved October 6, 2017.", "external_link": "https://www.youtube.com/watch?v=fevGZs0EQu8"}, {"index": 26, "title": "Elovitz, S. & Ahl, I. (2016, August 18). Know Your Enemy:  New Financially-Motivated & Spear-Phishing Group. Retrieved February 26, 2018.", "external_link": "https://www2.fireeye.com/WBNR-Know-Your-Enemy-UNC622-Spear-Phishing.html"}, {"index": 27, "title": "FireEye. (2018, October 03). APT38: Un-usual Suspects. Retrieved November 6, 2018.", "external_link": "https://content.fireeye.com/apt/rpt-apt38"}, {"index": 28, "title": "Dunwoody, M. and Carr, N.. (2016, September 27). No Easy Breach DerbyCon 2016. Retrieved October 4, 2016.", "external_link": "http://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016"}, {"index": 29, "title": "Fraser, N., et al. (2019, August 7). Double DragonAPT41, a dual espionage and cyber crime operation APT41. Retrieved September 23, 2019.", "external_link": "https://content.fireeye.com/apt-41/rpt-apt41"}, {"index": 30, "title": "Plett, C. et al.. (2017, October 16). wevtutil. Retrieved July 2, 2018.", "external_link": "https://docs.microsoft.com/windows-server/administration/windows-commands/wevtutil"}, {"index": 31, "title": "Microsoft. (n.d.). EventLog.Clear Method (). Retrieved July 2, 2018.", "external_link": "https://msdn.microsoft.com/library/system.diagnostics.eventlog.clear.aspx"}, {"index": 32, "title": "Microsoft. (n.d.). Clear-EventLog. Retrieved July 2, 2018.", "external_link": "https://docs.microsoft.com/powershell/module/microsoft.powershell.management/clear-eventlog"}], "related": [{"link": "https://attack.mitre.org/groups/G0007", "Name": "APT28", "Description": "APT28 has cleared event logs, including by using the commands wevtutil cl System and wevtutil cl Security.[20][21]"}, {"link": "https://attack.mitre.org/groups/G0016", "Name": "APT29", "Description": "APT29 used SDelete to remove artifacts from victims.[28]"}, {"link": "https://attack.mitre.org/groups/G0050", "Name": "APT32", "Description": "APT32 has cleared select event log entries.[24]"}, {"link": "https://attack.mitre.org/groups/G0082", "Name": "APT38", "Description": "APT38 clears Window Event logs and Sysmon logs from the system.[27]"}, {"link": "https://attack.mitre.org/groups/G0096", "Name": "APT41", "Description": "APT41 attempted to remove evidence of some of its activity by clearing Windows security and system events.[29]"}, {"link": "https://attack.mitre.org/software/S0239", "Name": "Bankshot", "Description": "Bankshot delets all artifacts associated with the malware from the infected machine.[6]"}, {"link": "https://attack.mitre.org/software/S0089", "Name": "BlackEnergy", "Description": "The BlackEnergy component KillDisk is capable of deleting Windows Event Logs.[7]"}, {"link": "https://attack.mitre.org/groups/G0074", "Name": "Dragonfly 2.0", "Description": "Dragonfly 2.0 cleared Windows event logs and other logs produced by tools they used, including system, security, terminal services, remote services, and audit logs. The actors also deleted specific Registry keys.[22][23]"}, {"link": "https://attack.mitre.org/groups/G0053", "Name": "FIN5", "Description": "FIN5 has cleared event logs from victims.[25]"}, {"link": "https://attack.mitre.org/groups/G0061", "Name": "FIN8", "Description": "FIN8 has cleared logs during post compromise cleanup activities.[26]"}, {"link": "https://attack.mitre.org/software/S0182", "Name": "FinFisher", "Description": "FinFisher clears the system event logs.[4][5]"}, {"link": "https://attack.mitre.org/software/S0032", "Name": "gh0st RAT", "Description": "gh0st RAT is able to wipe event logs.[11]"}, {"link": "https://attack.mitre.org/software/S0203", "Name": "Hydraq", "Description": "Hydraq creates a backdoor through which remote attackers can clear all system event logs.[13][14]"}, {"link": "https://attack.mitre.org/software/S0083", "Name": "Misdat", "Description": "Misdat is capable of deleting Registry keys used for persistence.[8]"}, {"link": "https://attack.mitre.org/software/S0368", "Name": "NotPetya", "Description": "NotPetya uses wevtutil to clear the Windows event logs.[18]"}, {"link": "https://attack.mitre.org/software/S0365", "Name": "Olympic Destroyer", "Description": "Olympic Destroyer will attempt to clear the System and Security event logs using wevtutil.[17]"}, {"link": "https://attack.mitre.org/software/S0229", "Name": "Orz", "Description": "Orz can overwrite Registry settings to reduce its visibility on the victim.[2]"}, {"link": "https://attack.mitre.org/software/S0113", "Name": "Prikormka", "Description": "After encrypting log files, the log encryption module in Prikormka deletes the original, unencrypted files from the host.[9]"}, {"link": "https://attack.mitre.org/software/S0279", "Name": "Proton", "Description": "Proton removes logs from /var/logs and /Library/logs.[10]"}, {"link": "https://attack.mitre.org/software/S0192", "Name": "Pupy", "Description": "Pupy has a module to clear event logs with PowerShell.[1]"}, {"link": "https://attack.mitre.org/software/S0148", "Name": "RTM", "Description": "RTM has the ability to remove Registry entries that it created during execution.[3]"}, {"link": "https://attack.mitre.org/software/S0253", "Name": "RunningRAT", "Description": "RunningRAT contains code to clear event logs.[15]"}, {"link": "https://attack.mitre.org/software/S0242", "Name": "SynAck", "Description": "SynAck clears event logs.[12]"}, {"link": "https://attack.mitre.org/software/S0330", "Name": "Zeus Panda", "Description": "Zeus Panda can uninstall scripts and delete files to cover its track.[16]"}, {"link": "https://attack.mitre.org/software/S0412", "Name": "ZxShell", "Description": "ZxShell has a command to clear system event logs. [19]"}, {"Mitigation": "Encrypt Sensitive Information", "Description": "Obfuscate/encrypt event files locally and in transit to avoid giving feedback to an adversary."}, {"Mitigation": "Remote Data Storage", "Description": "Automatically forward events to a log server or data repository to prevent conditions in which the adversary can locate and manipulate data on the local system. When possible, minimize time delay on event reporting to avoid prolonged storage on the local system."}, {"Mitigation": "Restrict File and Directory Permissions", "Description": "Protect generated event files that are stored locally with proper permissions and authentication and limit opportunities for adversaries to increase privileges by preventing Privilege Escalation opportunities."}]}