{"title": "Drive-by Compromise", "descrption": "\nA drive-by compromise is when an adversary gains access to a system through a user visiting a website over the normal course of browsing. With this technique, the user's web browser is typically targeted for exploitation, but adversaries may also use compromised websites for non-exploitation behavior such as acquiring application access tokens.Multiple ways of delivering exploit code to a browser exist, including:A legitimate website is compromised where adversaries have injected some form of malicious code such as JavaScript, iFrames, and cross-site scripting.Malicious ads are paid for and served through legitimate ad providers.Built-in web application interfaces are leveraged for the insertion of any other kind of object that can be used to display web content or contain a script that executes on the visiting client (e.g. forum posts, comments, and other user controllable web content).Often the website used by an adversary is one visited by a specific community, such as government, a particular industry, or region, where the goal is to compromise a specific user or set of users based on a shared interest. This kind of targeted attack is referred to a strategic web compromise or watering hole attack. There are several known examples of this occurring. Typical drive-by compromise process:A user visits a website that is used to host the adversary controlled content.Scripts automatically execute, typically searching versions of the browser and plugins for a potentially vulnerable version. The user may be required to assist in this process by enabling scripting or active website components and ignoring warning dialog boxes.Upon finding a vulnerable version, exploit code is delivered to the browser.If exploitation is successful, then it will give the adversary code execution on the user's system unless other protections are in place.In some cases a second visit to the website after the initial scan is required before exploit code is delivered.Unlike Exploit Public-Facing Application, the focus of this technique is to exploit software on a client endpoint upon visiting a website. This will commonly give an adversary access to systems on the internal network instead of external systems that may be in a DMZ.Adversaries may also use compromised websites to deliver a user to a malicious application designed to Steal Application Access Tokens, like OAuth tokens, to gain access to protected applications and information. These malicious applications have been delivered through popups on legitimate websites.\n", "ID": "T1189", "Tactic": "Initial Access", "Platform": "Windows, Linux, macOS, SaaS", "Permissions Required": "User", "Data Sources": "Packet capture, Network device logs, Process use of network, Web proxy, Network intrusion detection system, SSL/TLS inspection", "Contributors": "Jeff Sakowicz, Microsoft Identity Developer Platform Services (IDPM Services); Saisha Agrawal, Microsoft Threat Intelligent Center (MSTIC)", "Version": "1.1", "Created": "18 April 2018", "Last Modified": "11 October 2019", "related": [{"link": "https://attack.mitre.org/groups/G0073", "Name": "APT19", "Description": "APT19 performed a watering hole attack on forbes.com in 2014 to compromise targets.[19]"}, {"link": "https://attack.mitre.org/groups/G0050", "Name": "APT32", "Description": "APT32 has infected victims by tricking them into visiting compromised watering hole websites.[23]"}, {"link": "https://attack.mitre.org/groups/G0067", "Name": "APT37", "Description": "APT37 has used strategic web compromises, particularly of South Korean websites, to distribute malware. The group has also used torrent file-sharing sites to more indiscriminately disseminate malware to victims. As part of their compromises, the group has used a Javascript based profiler called RICECURRY to profile a victim's web browser and deliver malicious code accordingly.[17][7]"}, {"link": "https://attack.mitre.org/groups/G0082", "Name": "APT38", "Description": "APT38 has conducted watering holes schemes to gain initial access to victims.[24]"}, {"link": "https://attack.mitre.org/groups/G0060", "Name": "BRONZE BUTLER", "Description": "BRONZE BUTLER compromised three Japanese websites using a Flash exploit to perform watering hole attacks.[10]"}, {"link": "https://attack.mitre.org/groups/G0070", "Name": "Dark Caracal", "Description": "Dark Caracal leveraged a watering hole to serve up malicious code.[18]"}, {"link": "https://attack.mitre.org/groups/G0012", "Name": "Darkhotel", "Description": "Darkhotel used embedded iframes on hotel login portals to redirect selected victims to download malware.[25]"}, {"link": "https://attack.mitre.org/groups/G0074", "Name": "Dragonfly 2.0", "Description": "Dragonfly 2.0 compromised legitimate organizations' websites to create watering holes to compromise victims.[9]"}, {"link": "https://attack.mitre.org/groups/G0066", "Name": "Elderwood", "Description": "Elderwood has delivered zero-day exploits and malware to victims by injecting malicious code into specific public Web pages visited by targets within a particular sector.[11][12][13]"}, {"link": "https://attack.mitre.org/software/S0215", "Name": "KARAE", "Description": "KARAE was distributed through torrent file-sharing websites to South Korean victims, using a YouTube video downloader application as a lure.[7]"}, {"link": "https://attack.mitre.org/groups/G0032", "Name": "Lazarus Group", "Description": "Lazarus Group delivered RATANKBA to victims via a compromised legitimate website.[8]"}, {"link": "https://attack.mitre.org/groups/G0077", "Name": "Leafminer", "Description": "Leafminer has infected victims using watering holes.[14]"}, {"link": "https://attack.mitre.org/groups/G0040", "Name": "Patchwork", "Description": "Patchwork has used watering holes to deliver files with exploits to initial victims.[15][16]"}, {"link": "https://attack.mitre.org/groups/G0068", "Name": "PLATINUM", "Description": "PLATINUM has sometimes used drive-by attacks against vulnerable browser plugins.[20]"}, {"link": "https://attack.mitre.org/software/S0216", "Name": "POORAIM", "Description": "POORAIM has been delivered through compromised sites acting as watering holes.[7]"}, {"link": "https://attack.mitre.org/groups/G0027", "Name": "Threat Group-3390", "Description": "Threat Group-3390 has extensively used strategic web compromises to target victims.[21][22]"}, {"Mitigation": "Application Isolation and Sandboxing", "Description": "Browser sandboxes can be used to mitigate some of the impact of exploitation, but sandbox escapes may still exist.Other types of virtualization and application microsegmentation may also mitigate the impact of client-side exploitation. The risks of additional exploits and weaknesses in implementation may still exist for these types of systems.[3][4]"}, {"Mitigation": "Exploit Protection", "Description": "Security applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. Many of these protections depend on the architecture and target application binary for compatibility.[5][6]"}, {"Mitigation": "Restrict Web-Based Content", "Description": "For malicious code served up through ads, adblockers can help prevent that code from executing in the first place.Script blocking extensions can help prevent the execution of JavaScript that may commonly be used during the exploitation process."}, {"Mitigation": "Update Software", "Description": "Ensure all browsers and plugins kept updated can help prevent the exploit phase of this technique. Use modern browsers with security features turned on."}]}