{"title": "System Network Connections Discovery", "descrption": "\nAdversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network. An adversary who gains access to a system that is part of a cloud-based environment may map out Virtual Private Clouds or Virtual Networks in order to determine what systems and services are connected. The actions performed are likely the same types of discovery techniques depending on the operating system, but the resulting information may include details about the networked cloud environment relevant to the adversary's goals. Cloud providers may have different ways in which their virtual networks operate.[1][2][3]WindowsUtilities and commands that acquire this information include netstat, \"net use,\" and \"net session\" with Net.Mac and LinuxIn Mac and Linux, netstat and lsof can be used to list current connections. who -a and w can be used to show which users are currently logged in, similar to \"net session\".\n", "ID": "T1049", "Tactic": "Discovery", "Platform": "Linux, macOS, Windows, AWS, GCP, Azure", "Permissions Required": "User, Administrator", "Data Sources": "Process monitoring, Process command-line parameters", "Contributors": "Praetorian", "Version": "2.0", "Created": "31 May 2017", "Last Modified": "06 October 2019", "references": [{"index": 1, "title": "Amazon. (n.d.). What Is Amazon VPC?. Retrieved October 6, 2019.", "external_link": "https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html"}, {"index": 2, "title": "Annamalai, N., Casey, C., Almeida, M., et. al.. (2019, June 18). What is Azure Virtual Network?. Retrieved October 6, 2019.", "external_link": "https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview"}, {"index": 3, "title": "Google. (2019, September 23). Virtual Private Cloud (VPC) network overview. Retrieved October 6, 2019.", "external_link": "https://cloud.google.com/vpc/docs/vpc"}, {"index": 4, "title": "Nicolas Verdier. (n.d.). Retrieved January 29, 2018.", "external_link": "https://github.com/n1nj4sec/pupy"}, {"index": 5, "title": "Microsoft. (n.d.). Netstat. Retrieved April 17, 2016.", "external_link": "https://technet.microsoft.com/en-us/library/bb490947.aspx"}, {"index": 6, "title": "Savill, J. (1999, March 4). Net.exe reference. Retrieved September 22, 2015.", "external_link": "http://windowsitpro.com/windows/netexe-reference"}, {"index": 7, "title": "Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.", "external_link": "https://github.com/PowerShellEmpire/Empire"}, {"index": 8, "title": "Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.", "external_link": "https://github.com/nettitude/PoshC2_Python"}, {"index": 9, "title": "Trend Micro. (2017, February 27). RATANKBA: Delving into Large-scale Watering Holes against Enterprises. Retrieved May 22, 2018.", "external_link": "https://blog.trendmicro.com/trendlabs-security-intelligence/ratankba-watering-holes-against-enterprises/"}, {"index": 10, "title": "Symantec Security Response. (2016, September 6). Buckeye cyberespionage group shifts gaze from US to Hong Kong. Retrieved September 26, 2016.", "external_link": "http://www.symantec.com/connect/blogs/buckeye-cyberespionage-group-shifts-gaze-us-hong-kong"}, {"index": 11, "title": "Kaspersky Lab's Global Research and Analysis Team. (2014, August 7). The Epic Turla Operation: Solving some of the mysteries of Snake/Uroburos. Retrieved December 11, 2014.", "external_link": "https://securelist.com/the-epic-turla-operation/65545/"}, {"index": 12, "title": "Kaspersky Lab's Global Research & Analysis Team. (2014, August 06). The Epic Turla Operation: Solving some of the mysteries of Snake/Uroboros. Retrieved November 7, 2018.", "external_link": "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/08080105/KL_Epic_Turla_Technical_Appendix_20140806.pdf"}, {"index": 13, "title": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.", "external_link": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"}, {"index": 14, "title": "Symantec Security Response. (2011, November). W32.Duqu: The precursor to the next Stuxnet. Retrieved September 17, 2015.", "external_link": "https://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/w32_duqu_the_precursor_to_the_next_stuxnet.pdf"}, {"index": 15, "title": "Blasco, J. (2011, December 12). Another Sykipot sample likely targeting US federal agencies. Retrieved March 28, 2016.", "external_link": "https://www.alienvault.com/open-threat-exchange/blog/another-sykipot-sample-likely-targeting-us-federal-agencies"}, {"index": 16, "title": "Symantec Security Response Attack Investigation Team. (2018, April 23). New Orangeworm attack group targets the healthcare sector in the U.S., Europe, and Asia. Retrieved May 8, 2018.", "external_link": "https://www.symantec.com/blogs/threat-intelligence/orangeworm-targets-healthcare-us-europe-asia"}, {"index": 17, "title": "Kaspersky Lab's Global Research & Analysis Team. (2016, August 9). The ProjectSauron APT. Technical Analysis. Retrieved August 17, 2016.", "external_link": "https://securelist.com/files/2016/07/The-ProjectSauron-APT_Technical_Analysis_KL.pdf"}, {"index": 18, "title": "Grunzweig, J. (2018, January 31). Comnie Continues to Target Organizations in East Asia. Retrieved June 7, 2018.", "external_link": "https://researchcenter.paloaltonetworks.com/2018/01/unit42-comnie-continues-target-organizations-east-asia/"}, {"index": 19, "title": "GovCERT. (2016, May 23). Technical Report about the Espionage Case at RUAG. Retrieved November 7, 2018.", "external_link": "https://www.melani.admin.ch/dam/melani/de/dokumente/2016/technical%20report%20ruag.pdf.download.pdf/Report_Ruag-Espionage-Case.pdf"}, {"index": 20, "title": "Falcone, R. and Wartell, R.. (2015, July 27). Observations on CVE-2015-3113, Prior Zero-Days and the Pirpi Payload. Retrieved January 22, 2016.", "external_link": "http://researchcenter.paloaltonetworks.com/2015/07/ups-observations-on-cve-2015-3113-prior-zero-days-and-the-pirpi-payload/"}, {"index": 21, "title": "Yagi, J. (2014, August 24). Trojan.Volgmer. Retrieved July 16, 2018.", "external_link": "https://www.symantec.com/security-center/writeup/2014-081811-3237-99?tabid=2"}, {"index": 22, "title": "F-Secure Labs. (2014). BlackEnergy & Quedagh: The convergence of crimeware and APT attacks. Retrieved March 24, 2016.", "external_link": "https://www.f-secure.com/documents/996508/1030745/blackenergy_whitepaper.pdf"}, {"index": 23, "title": "Baumgartner, K. and Garnaeva, M.. (2014, November 3). BE2 custom plugins, router abuse, and target profiles. Retrieved March 24, 2016.", "external_link": "https://securelist.com/be2-custom-plugins-router-abuse-and-target-profiles/67353/"}, {"index": 24, "title": "Mercer, W., Rascagneres, P. (2018, April 26). GravityRAT - The Two-Year Evolution Of An APT Targeting India. Retrieved May 16, 2018.", "external_link": "https://blog.talosintelligence.com/2018/04/gravityrat-two-year-evolution-of-apt.html"}, {"index": 25, "title": "PwC and BAE Systems. (2017, April). Operation Cloud Hopper: Technical Annex. Retrieved April 13, 2017.", "external_link": "https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf"}, {"index": 26, "title": "Computer Incident Response Center Luxembourg. (2013, March 29). Analysis of a PlugX variant. Retrieved November 5, 2018.", "external_link": "http://circl.lu/assets/files/tr-12/tr-12-circl-plugx-analysis-v1.pdf"}, {"index": 27, "title": "Check Point Research. (2019, February 4). SpeakUp: A New Undetected Backdoor Linux Trojan. Retrieved April 17, 2019.", "external_link": "https://research.checkpoint.com/speakup-a-new-undetected-backdoor-linux-trojan/"}, {"index": 28, "title": "Kamluk, V. & Gostev, A. (2016, February). Adwind - A Cross-Platform RAT. Retrieved April 23, 2019.", "external_link": "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07195002/KL_AdwindPublicReport_2016.pdf"}, {"index": 29, "title": "ESET Research. (2019, May 22). A journey to Zebrocy land. Retrieved June 20, 2019.", "external_link": "https://www.welivesecurity.com/2019/05/22/journey-zebrocy-land/"}, {"index": 30, "title": "ESET. (2019, July). MACHETE JUST GOT SHARPER Venezuelan government institutions under attack. Retrieved September 13, 2019.", "external_link": "https://www.welivesecurity.com/wp-content/uploads/2019/08/ESET_Machete.pdf"}, {"index": 31, "title": "Kaspersky Lab's Global Research and Analysis Team. (2016, February 9). Poseidon Group: a Targeted Attack Boutique specializing in global cyber-espionage. Retrieved March 16, 2016.", "external_link": "https://securelist.com/poseidon-group-a-targeted-attack-boutique-specializing-in-global-cyber-espionage/73673/"}, {"index": 32, "title": "PwC and BAE Systems. (2017, April). Operation Cloud Hopper. Retrieved April 5, 2017.", "external_link": "https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-report-final-v4.pdf"}, {"index": 33, "title": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.", "external_link": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/"}, {"index": 34, "title": "Counter Threat Unit Research Team. (2017, June 27). BRONZE UNION Cyberespionage Persists Despite Disclosures. Retrieved July 13, 2017.", "external_link": "https://www.secureworks.com/research/bronze-union"}, {"index": 35, "title": "Chen, X., Scott, M., Caselden, D.. (2014, April 26). New Zero-Day Exploit targeting Internet Explorer Versions 9 through 11 Identified in Targeted Attacks. Retrieved January 14, 2016.", "external_link": "https://www.fireeye.com/blog/threat-research/2014/04/new-zero-day-exploit-targeting-internet-explorer-versions-9-through-11-identified-in-targeted-attacks.html"}, {"index": 36, "title": "Yates, M. (2017, June 18). APT3 Uncovered: The code evolution of Pirpi. Retrieved September 28, 2017.", "external_link": "https://recon.cx/2017/montreal/resources/slides/RECON-MTL-2017-evolution_of_pirpi.pdf"}, {"index": 37, "title": "Dahan, A. (2017). Operation Cobalt Kitty. Retrieved December 27, 2018.", "external_link": "https://cdn2.hubspot.net/hubfs/3354902/Cybereason%20Labs%20Analysis%20Operation%20Cobalt%20Kitty.pdf"}, {"index": 38, "title": "FireEye Threat Intelligence. (2015, December 1). China-based Cyber Threat Group Uses Dropbox for Malware Communications and Targets Hong Kong Media Outlets. Retrieved December 4, 2015.", "external_link": "https://www.fireeye.com/blog/threat-research/2015/11/china-based-threat.html"}, {"index": 39, "title": "Mandiant. (n.d.). APT1 Exposing One of China\u2019s Cyber Espionage Units. Retrieved July 18, 2016.", "external_link": "https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/mandiant-apt1-report.pdf"}, {"index": 40, "title": "Villeneuve, N., Bennett, J. T., Moran, N., Haq, T., Scott, M., & Geers, K. (2014). OPERATION \u201cKE3CHANG\u201d: Targeted Attacks Against Ministries of Foreign Affairs. Retrieved November 12, 2014.", "external_link": "https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-operation-ke3chang.pdf"}, {"index": 41, "title": "Smallridge, R. (2018, March 10). APT15 is alive and strong: An analysis of RoyalCli and RoyalDNS. Retrieved April 4, 2018.", "external_link": "https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/"}, {"index": 42, "title": "Faou, M. and Dumont R.. (2019, May 29). A dive into Turla PowerShell usage. Retrieved June 14, 2019.", "external_link": "https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/"}, {"index": 43, "title": "Cybereason Nocturnus. (2019, June 25). Operation Soft Cell: A Worldwide Campaign Against Telecommunications Providers. Retrieved July 18, 2019.", "external_link": "https://www.cybereason.com/blog/operation-soft-cell-a-worldwide-campaign-against-telecommunications-providers"}, {"index": 44, "title": "FireEye. (2018, October 03). APT38: Un-usual Suspects. Retrieved November 6, 2018.", "external_link": "https://content.fireeye.com/apt/rpt-apt38"}, {"index": 45, "title": "Fraser, N., et al. (2019, August 7). Double DragonAPT41, a dual espionage and cyber crime operation APT41. Retrieved September 23, 2019.", "external_link": "https://content.fireeye.com/apt-41/rpt-apt41"}], "related": [{"link": "https://attack.mitre.org/groups/G0018", "Name": "admin@338", "Description": "admin@338 actors used the following command following exploitation of a machine with LOWBALL malware to display network connections: netstat -ano >> %temp%\\download[38]"}, {"link": "https://attack.mitre.org/groups/G0006", "Name": "APT1", "Description": "APT1 used the net use command to get a listing on network connections.[39]"}, {"link": "https://attack.mitre.org/groups/G0022", "Name": "APT3", "Description": "APT3 has a tool that can enumerate current network connections.[10][35][36]"}, {"link": "https://attack.mitre.org/groups/G0050", "Name": "APT32", "Description": "APT32 used the netstat -anpo tcp command to display TCP connections on the victim's machine.[37]"}, {"link": "https://attack.mitre.org/groups/G0082", "Name": "APT38", "Description": "APT38 installed a port monitoring tool, MAPMAKER, to print the active TCP connections on the local system.[44]"}, {"link": "https://attack.mitre.org/groups/G0096", "Name": "APT41", "Description": "APT41 used the netstat command as part of network reconnaissance. The group has also used a malware variant, HIGHNOON, to enumerate active RDP sessions. [45]"}, {"link": "https://attack.mitre.org/software/S0089", "Name": "BlackEnergy", "Description": "BlackEnergy has gathered information about local network connections using netstat.[22][23]"}, {"link": "https://attack.mitre.org/software/S0335", "Name": "Carbon", "Description": "Carbon uses the netstat -r and netstat -an commands.[19]"}, {"link": "https://attack.mitre.org/software/S0244", "Name": "Comnie", "Description": "Comnie executes the netstat -ano command.[18]"}, {"link": "https://attack.mitre.org/software/S0038", "Name": "Duqu", "Description": "The discovery modules used with Duqu can collect information on network connections.[14]"}, {"link": "https://attack.mitre.org/software/S0363", "Name": "Empire", "Description": "Empire can enumerate the current network connections of a host.[7]"}, {"link": "https://attack.mitre.org/software/S0091", "Name": "Epic", "Description": "Epic uses the net use, net session, and netstat commands to gather information on network connections.[11][12]"}, {"link": "https://attack.mitre.org/software/S0237", "Name": "GravityRAT", "Description": "GravityRAT uses the netstat command to find open ports on the victim\u2019s machine.[24]"}, {"link": "https://attack.mitre.org/software/S0283", "Name": "jRAT", "Description": "jRAT can list network connections.[28]"}, {"link": "https://attack.mitre.org/groups/G0004", "Name": "Ke3chang", "Description": "Ke3chang performs local network connection discovery using netstat.[40][41]"}, {"link": "https://attack.mitre.org/software/S0236", "Name": "Kwampirs", "Description": "Kwampirs collects a list of active and listening connections by using the command netstat -nao as well as a list of available network mappings with net use.[16]"}, {"link": "https://attack.mitre.org/software/S0409", "Name": "Machete", "Description": "Machete uses the netsh wlan show networks mode=bssid and netsh wlan show interfaces commands to list all nearby WiFi networks and connected interfaces. [30]"}, {"link": "https://attack.mitre.org/groups/G0045", "Name": "menuPass", "Description": "menuPass has used net use to conduct connectivity checks to machines.[32]"}, {"link": "https://attack.mitre.org/software/S0102", "Name": "nbtstat", "Description": "nbtstat can be used to discover current NetBIOS sessions."}, {"link": "https://attack.mitre.org/software/S0039", "Name": "Net", "Description": "Commands such as net use and net session can be used in Net to gather information about network connections from a particular host.[6]"}, {"link": "https://attack.mitre.org/software/S0104", "Name": "netstat", "Description": "netstat can be used to enumerate local network connections, including active TCP connections and other network statistics.[5]"}, {"link": "https://attack.mitre.org/groups/G0049", "Name": "OilRig", "Description": "OilRig has used netstat -an on a victim to get a listing of network connections.[33]"}, {"link": "https://attack.mitre.org/software/S0165", "Name": "OSInfo", "Description": "OSInfo enumerates the current network connections similar to  net use .[10]"}, {"link": "https://attack.mitre.org/software/S0013", "Name": "PlugX", "Description": "PlugX has a module for enumerating TCP and UDP network connections and associated processes using the netstat command.[26]"}, {"link": "https://attack.mitre.org/groups/G0033", "Name": "Poseidon Group", "Description": "Poseidon Group obtains and saves information about victim network interfaces and addresses.[31]"}, {"link": "https://attack.mitre.org/software/S0378", "Name": "PoshC2", "Description": "PoshC2 contains an implementation of netstat to enumerate TCP and UDP connections.[8]"}, {"link": "https://attack.mitre.org/software/S0184", "Name": "POWRUNER", "Description": "POWRUNER may collect active network connections by running netstat -an on a victim.[13]"}, {"link": "https://attack.mitre.org/software/S0192", "Name": "Pupy", "Description": "Pupy has a built-in utility command for netstat, can do net session through PowerView, and has an interactive shell which can be used to discover additional information.[4]"}, {"link": "https://attack.mitre.org/software/S0241", "Name": "RATANKBA", "Description": "RATANKBA uses netstat -ano to search for specific IP address ranges.[9]"}, {"link": "https://attack.mitre.org/software/S0153", "Name": "RedLeaves", "Description": "RedLeaves can enumerate drives and Remote Desktop sessions.[25]"}, {"link": "https://attack.mitre.org/software/S0125", "Name": "Remsec", "Description": "Remsec can obtain a list of active connections and open ports.[17]"}, {"link": "https://attack.mitre.org/software/S0063", "Name": "SHOTPUT", "Description": "SHOTPUT uses netstat to list TCP connection status.[20]"}, {"link": "https://attack.mitre.org/groups/G0093", "Name": "Soft Cell", "Description": "Soft Cell used netstat -oan to obtain information about the victim network connections.[43]"}, {"link": "https://attack.mitre.org/software/S0374", "Name": "SpeakUp", "Description": "SpeakUp uses the arp -a command.[27]"}, {"link": "https://attack.mitre.org/software/S0018", "Name": "Sykipot", "Description": "Sykipot may use netstat -ano to display active network connections.[15]"}, {"link": "https://attack.mitre.org/groups/G0027", "Name": "Threat Group-3390", "Description": "Threat Group-3390 has used net use to conduct internal discovery of systems. The group has also used quser.exe to identify existing RDP sessions on a victim.[34]"}, {"link": "https://attack.mitre.org/groups/G0010", "Name": "Turla", "Description": "Turla surveys a system upon check-in to discover active local network connections using the netstat -an, net use, net file, and net session commands. Turla RPC backdoors have also enumerated the IPv4 TCP connection table via the GetTcpTable2 API call.[11][42]"}, {"link": "https://attack.mitre.org/software/S0180", "Name": "Volgmer", "Description": "Volgmer can gather information about TCP connection state.[21]"}, {"link": "https://attack.mitre.org/software/S0251", "Name": "Zebrocy", "Description": "Zebrocy uses netstat -aon to gather network connection information.[29]"}]}