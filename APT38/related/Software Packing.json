{"title": "Software Packing", "descrption": "\nSoftware packing is a method of compressing or encrypting an executable. Packing an executable changes the file signature in an attempt to avoid signature-based detection. Most decompression techniques decompress the executable code in memory.Utilities used to perform software packing are called packers. Example packers are MPRESS and UPX. A more comprehensive list of known packers is available, [1] but adversaries may create their own packing techniques that do not leave the same artifacts as well-known packers to evade defenses.Adversaries may use virtual machine software protection as a form of software packing to protect their code. Virtual machine software protection translates an executable's original code into a special format that only a special virtual machine can run. A virtual machine is then called to run this code.[2]\n", "ID": "T1045", "Tactic": "Defense Evasion", "Platform": "Windows, macOS", "Data Sources": "Binary file metadata", "Defense Bypassed": "Signature-based detection, Anti-virus, Heuristic detection", "CAPEC ID": "CAPEC-570", "Contributors": "Filip Kafka, ESET", "Version": "1.1", "Created": "31 May 2017", "Last Modified": "26 September 2019", "references": [{"index": 1, "title": "Executable compression. (n.d.). Retrieved December 4, 2014.", "external_link": "http://en.wikipedia.org/wiki/Executable_compression"}, {"index": 2, "title": "Kafka, F. (2018, January). ESET's Guide to Deobfuscating and Devirtualizing FinFisher. Retrieved August 12, 2019.", "external_link": "https://www.welivesecurity.com/wp-content/uploads/2018/01/WP-FinFisher.pdf"}, {"index": 3, "title": "Reynolds, J.. (2016, September 13). H1N1: Technical analysis reveals new capabilities. Retrieved September 26, 2016.", "external_link": "http://blogs.cisco.com/security/h1n1-technical-analysis-reveals-new-capabilities"}, {"index": 4, "title": "Lancaster, T., Cortes, J. (2018, January 29). VERMIN: Quasar RAT and Custom Malware Used In Ukraine. Retrieved July 5, 2018.", "external_link": "https://researchcenter.paloaltonetworks.com/2018/01/unit42-vermin-quasar-rat-custom-malware-used-ukraine/"}, {"index": 5, "title": "Chen, J. and Hsieh, M. (2017, November 7). REDBALDKNIGHT/BRONZE BUTLER\u2019s Daserf Backdoor Now Using Steganography. Retrieved December 27, 2017.", "external_link": "http://blog.trendmicro.com/trendlabs-security-intelligence/redbaldknight-bronze-butler-daserf-backdoor-now-using-steganography/"}, {"index": 6, "title": "Grunzweig, J.. (2015, July 14). Unit 42 Technical Analysis: Seaduke. Retrieved August 3, 2016.", "external_link": "http://researchcenter.paloaltonetworks.com/2015/07/unit-42-technical-analysis-seaduke/"}, {"index": 7, "title": "Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018.", "external_link": "https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/"}, {"index": 8, "title": "Salinas, M., Holguin, J. (2017, June). Evolution of Trickbot. Retrieved July 31, 2018.", "external_link": "https://www.securityartwork.es/wp-content/uploads/2017/07/Trickbot-report-S2-Grupo.pdf"}, {"index": 9, "title": "Schwarz, D., Sopko J. (2018, March 08). Donot Team Leverages New Modular Malware Framework in South Asia. Retrieved June 11, 2018.", "external_link": "https://www.arbornetworks.com/blog/asert/donot-team-leverages-new-modular-malware-framework-south-asia/"}, {"index": 10, "title": "Symantec Security Response. (2014, July 7). Dragonfly: Cyberespionage Attacks Against Energy Suppliers. Retrieved April 8, 2016.", "external_link": "http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/Dragonfly_Threat_Against_Western_Energy_Suppliers.pdf"}, {"index": 11, "title": "Cherepanov, A. (2018, October). GREYENERGY A successor to BlackEnergy. Retrieved November 15, 2018.", "external_link": "https://www.welivesecurity.com/wp-content/uploads/2018/10/ESET_GreyEnergy.pdf"}, {"index": 12, "title": "Huss, D., et al. (2017, February 2). Oops, they did it again: APT Targets Russia and Belarus with ZeroT and PlugX. Retrieved April 5, 2018.", "external_link": "https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx"}, {"index": 13, "title": "Symantec. (2015, January 26). The Waterbug attack group. Retrieved April 10, 2015.", "external_link": "http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/waterbug-attack-group.pdf"}, {"index": 14, "title": "FinFisher. (n.d.). Retrieved December 20, 2017.", "external_link": "http://www.finfisher.com/FinFisher/index.html"}, {"index": 15, "title": "Kaspersky Lab's Global Research & Analysis Team. (2017, October 16). BlackOasis APT and new targeted attacks leveraging zero-day exploit. Retrieved February 15, 2018.", "external_link": "https://securelist.com/blackoasis-apt-and-new-targeted-attacks-leveraging-zero-day-exploit/82732/"}, {"index": 16, "title": "Kujawa, A. (2018, March 27). You dirty RAT! Part 1: DarkComet. Retrieved November 6, 2018.", "external_link": "https://blog.malwarebytes.com/threat-analysis/2012/06/you-dirty-rat-part-1-darkcomet/"}, {"index": 17, "title": "Trend Micro. (2019, January 16). Exploring Emotet's Activities . Retrieved March 25, 2019.", "external_link": "https://documents.trendmicro.com/assets/white_papers/ExploringEmotetsActivities_Final.pdf"}, {"index": 18, "title": "Salem, E. (2019, February 13). ASTAROTH MALWARE USES LEGITIMATE OS AND ANTIVIRUS PROCESSES TO STEAL PASSWORDS AND PERSONAL DATA. Retrieved April 17, 2019.", "external_link": "https://www.cybereason.com/blog/information-stealing-malware-targeting-brazil-full-research"}, {"index": 19, "title": "Lee, B., Falcone, R. (2018, December 12). Dear Joohn: The Sofacy Group\u2019s Global Campaign. Retrieved April 19, 2019.", "external_link": "https://unit42.paloaltonetworks.com/dear-joohn-sofacy-groups-global-campaign/"}, {"index": 20, "title": "Accenture Security. (2018, November 29). SNAKEMACKEREL. Retrieved April 15, 2019.", "external_link": "https://www.accenture.com/t20181129T203820Z__w__/us-en/_acnmedia/PDF-90/Accenture-snakemackerel-delivers-zekapab-malware.pdf#zoom=50"}, {"index": 21, "title": "Lee, T., Hanzlik, D., Ahl, I. (2013, August 7). Breaking Down the China Chopper Web Shell - Part I. Retrieved March 27, 2015.", "external_link": "https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-i.html"}, {"index": 22, "title": "Kamluk, V. & Gostev, A. (2016, February). Adwind - A Cross-Platform RAT. Retrieved April 23, 2019.", "external_link": "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07195002/KL_AdwindPublicReport_2016.pdf"}, {"index": 23, "title": "Dumont, R.. (2019, April 9). OceanLotus: macOS malware update. Retrieved April 15, 2019.", "external_link": "https://www.welivesecurity.com/2019/04/09/oceanlotus-macos-malware-update/"}, {"index": 24, "title": "ESET. (2019, July). MACHETE JUST GOT SHARPER Venezuelan government institutions under attack. Retrieved September 13, 2019.", "external_link": "https://www.welivesecurity.com/wp-content/uploads/2019/08/ESET_Machete.pdf"}, {"index": 25, "title": "O'Gorman, G., and McDonald, G.. (2012, September 6). The Elderwood Project. Retrieved February 15, 2018.", "external_link": "http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/the-elderwood-project.pdf"}, {"index": 26, "title": "Dunwoody, M. and Carr, N.. (2016, September 27). No Easy Breach DerbyCon 2016. Retrieved October 4, 2016.", "external_link": "http://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016"}, {"index": 27, "title": "Kaspersky Lab's Global Research & Analysis Team. (2016, July 8). The Dropping Elephant \u2013 aggressive cyber-espionage in the Asian region. Retrieved August 3, 2016.", "external_link": "https://securelist.com/the-dropping-elephant-actor/75328/"}, {"index": 28, "title": "Korban, C, et al. (2017, September). APT3 Adversary Emulation Plan. Retrieved January 16, 2018.", "external_link": "https://attack.mitre.org/docs/APT3_Adversary_Emulation_Plan.pdf"}, {"index": 29, "title": "FireEye. (2018, October 03). APT38: Un-usual Suspects. Retrieved November 6, 2018.", "external_link": "https://content.fireeye.com/apt/rpt-apt38"}, {"index": 30, "title": "Blaich, A., et al. (2018, January 18). Dark Caracal: Cyber-espionage at a Global Scale. Retrieved April 11, 2018.", "external_link": "https://info.lookout.com/rs/051-ESQ-475/images/Lookout_Dark-Caracal_srr_20180118_us_v.1.0.pdf"}, {"index": 31, "title": "Scott-Railton, J., et al. (2016, August 2). Group5: Syria and the Iranian Connection. Retrieved September 26, 2016.", "external_link": "https://citizenlab.ca/2016/08/group5-syria/"}, {"index": 32, "title": "McAfee\u00ae Foundstone\u00ae Professional Services and McAfee Labs\u2122. (2011, February 10). Global Energy Cyberattacks: \u201cNight Dragon\u201d. Retrieved February 19, 2018.", "external_link": "https://securingtomorrow.mcafee.com/wp-content/uploads/2011/02/McAfee_NightDragon_wp_draft_to_customersv1-1.pdf"}, {"index": 33, "title": "Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019.", "external_link": "https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html"}, {"index": 34, "title": "Livelli, K, et al. (2018, November 12). Operation Shaheen. Retrieved May 1, 2019.", "external_link": "https://www.cylance.com/content/dam/cylance-web/en-us/resources/knowledge-center/resource-library/reports/WhiteCompanyOperationShaheenReport.pdf?_ga=2.161661948.1943296560.1555683782-1066572390.1555511517"}, {"index": 35, "title": "Cybereason Nocturnus. (2019, June 25). Operation Soft Cell: A Worldwide Campaign Against Telecommunications Providers. Retrieved July 18, 2019.", "external_link": "https://www.cybereason.com/blog/operation-soft-cell-a-worldwide-campaign-against-telecommunications-providers"}], "related": [{"link": "https://attack.mitre.org/groups/G0016", "Name": "APT29", "Description": "APT29 used UPX to pack files.[26]"}, {"link": "https://attack.mitre.org/groups/G0022", "Name": "APT3", "Description": "APT3 has been known to pack their tools.[28]"}, {"link": "https://attack.mitre.org/groups/G0082", "Name": "APT38", "Description": "APT38 has used several code packing methods such as Themida, Enigma, VMProtect, and Obsidium, to pack their implants.[29]"}, {"link": "https://attack.mitre.org/groups/G0087", "Name": "APT39", "Description": "APT39 has repacked a modified version of Mimikatz to thwart anti-virus detection.[33]"}, {"link": "https://attack.mitre.org/software/S0373", "Name": "Astaroth", "Description": "Astaroth uses a software packer called Pe123\\RPolyCryptor.[18]"}, {"link": "https://attack.mitre.org/software/S0020", "Name": "China Chopper", "Description": "China Chopper's client component is packed with UPX.[21]"}, {"link": "https://attack.mitre.org/groups/G0070", "Name": "Dark Caracal", "Description": "Dark Caracal has used UPX to pack Bandook.[30]"}, {"link": "https://attack.mitre.org/software/S0334", "Name": "DarkComet", "Description": "DarkComet has the option to compress its payload using UPX or MPRESS.[16]"}, {"link": "https://attack.mitre.org/software/S0187", "Name": "Daserf", "Description": "A version of Daserf uses the MPRESS packer.[5]"}, {"link": "https://attack.mitre.org/groups/G0066", "Name": "Elderwood", "Description": "Elderwood has packed malware payloads before delivery to victims.[25]"}, {"link": "https://attack.mitre.org/software/S0367", "Name": "Emotet", "Description": "Emotet has used custom packers to protect its payloads.[17]"}, {"link": "https://attack.mitre.org/software/S0182", "Name": "FinFisher", "Description": "A FinFisher variant uses a custom packer.[14][15]"}, {"link": "https://attack.mitre.org/software/S0342", "Name": "GreyEnergy", "Description": "GreyEnergy is packed for obfuscation.[11]"}, {"link": "https://attack.mitre.org/groups/G0043", "Name": "Group5", "Description": "Group5 packed an executable by base64 encoding the PE file and breaking it up into numerous lines.[31]"}, {"link": "https://attack.mitre.org/software/S0132", "Name": "H1N1", "Description": "H1N1 uses a custom packing algorithm.[3]"}, {"link": "https://attack.mitre.org/software/S0283", "Name": "jRAT", "Description": "jRAT payloads have been packed.[22]"}, {"link": "https://attack.mitre.org/software/S0409", "Name": "Machete", "Description": "Machete has been packed with NSIS. [24]"}, {"link": "https://attack.mitre.org/groups/G0014", "Name": "Night Dragon", "Description": "Night Dragon is known to use software packing in its tools.[32]"}, {"link": "https://attack.mitre.org/software/S0264", "Name": "OopsIE", "Description": "OopsIE uses the SmartAssembly obfuscator to pack an embedded .Net Framework assembly used for C2.[7]"}, {"link": "https://attack.mitre.org/software/S0352", "Name": "OSX_OCEANLOTUS.D", "Description": "OSX_OCEANLOTUS.D has a variant that is packed with UPX.[23]"}, {"link": "https://attack.mitre.org/groups/G0040", "Name": "Patchwork", "Description": "A Patchwork payload was packed with UPX.[27]"}, {"link": "https://attack.mitre.org/software/S0053", "Name": "SeaDuke", "Description": "SeaDuke has been packed with the UPX packer.[6]"}, {"link": "https://attack.mitre.org/groups/G0093", "Name": "Soft Cell", "Description": "Soft Cell packed some payloads using different types of packers, both known and custom.[35]"}, {"link": "https://attack.mitre.org/groups/G0089", "Name": "The White Company", "Description": "The White Company has obfuscated their payloads through packing.[34]"}, {"link": "https://attack.mitre.org/software/S0266", "Name": "TrickBot", "Description": "TrickBot leverages a custom packer to obfuscate its functionality.[8]"}, {"link": "https://attack.mitre.org/software/S0094", "Name": "Trojan.Karagany", "Description": "Trojan.Karagany samples sometimes use common binary packers such as UPX and Aspack on top of a custom Delphi binary packer.[10]"}, {"link": "https://attack.mitre.org/software/S0022", "Name": "Uroburos", "Description": "Uroburos uses a custom packer.[13]"}, {"link": "https://attack.mitre.org/software/S0257", "Name": "VERMIN", "Description": "VERMIN is initially packed.[4]"}, {"link": "https://attack.mitre.org/software/S0248", "Name": "yty", "Description": "yty packs a plugin with UPX.[9]"}, {"link": "https://attack.mitre.org/software/S0251", "Name": "Zebrocy", "Description": "Zebrocy's Delphi variant was packed with UPX.[19][20]"}, {"link": "https://attack.mitre.org/software/S0230", "Name": "ZeroT", "Description": "Some ZeroT DLL files have been packed with UPX.[12]"}, {"Mitigation": "Antivirus/Antimalware", "Description": "Employ heuristic-based malware detection. Ensure updated virus definitions and create custom signatures for observed malware."}]}